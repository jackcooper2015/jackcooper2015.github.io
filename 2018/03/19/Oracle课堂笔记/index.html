<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="jackcooper" type="application/atom+xml" />






<meta name="description" content="oracle课堂笔记包含ddl，dml，tcl，游标，过程，函数，触发器等详细demo。志在帮助小白变大神  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767">
<meta property="og:type" content="article">
<meta property="og:title" content="Oracle课堂笔记">
<meta property="og:url" content="http:/jackcooper.github.io/2018/03/19/Oracle课堂笔记/index.html">
<meta property="og:site_name" content="jackcooper">
<meta property="og:description" content="oracle课堂笔记包含ddl，dml，tcl，游标，过程，函数，触发器等详细demo。志在帮助小白变大神  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-08-31T02:10:08.110Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Oracle课堂笔记">
<meta name="twitter:description" content="oracle课堂笔记包含ddl，dml，tcl，游标，过程，函数，触发器等详细demo。志在帮助小白变大神  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"right","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http:/jackcooper.github.io/2018/03/19/Oracle课堂笔记/"/>





  <title>Oracle课堂笔记 | jackcooper</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d876a707ce65a460fa37f2163d89c6e2";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>


<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">













  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>
<a href="https://github.com/jackcooper2015/jackcooper2015.github.io"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png" alt="Fork me on GitHub"></a>

 <div class="bg_content">
      <canvas id="canvas"></canvas>
 </div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">jackcooper</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http:/jackcooper.github.io/2018/03/19/Oracle课堂笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jackcooper">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/jackcooper.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jackcooper">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Oracle课堂笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-19T17:17:12+08:00">
                2018-03-19
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/03/19/Oracle课堂笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/19/Oracle课堂笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-eye"></i> 阅读次数
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>oracle课堂笔记包含ddl，dml，tcl，游标，过程，函数，触发器等详细demo。志在帮助小白变大神</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--创建</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">create tablespace student1</span></span><br><span class="line"><span class="comment">datafile 'E:\oracle\product\10.2.0\oradata\dafiles\student.dbf'</span></span><br><span class="line"><span class="comment">size 10M</span></span><br><span class="line"><span class="comment">autoextend on</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> new_dept;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> newdept</span><br><span class="line"><span class="keyword">as</span> <span class="keyword">select</span> * <span class="keyword">from</span> scott.dept;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> salgrade</span><br><span class="line"><span class="keyword">as</span> <span class="keyword">select</span> * <span class="keyword">from</span> scott.salgrade;</span><br><span class="line"></span><br><span class="line"><span class="comment">--1.  创建一个学生表包含：学号、姓名、性别、年龄、出生日期等 字段。</span></span><br><span class="line"> <span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">   cno <span class="built_in">number</span>(<span class="number">5</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   cname <span class="built_in">varchar</span>(<span class="number">10</span>),</span><br><span class="line">   sex <span class="built_in">char</span>(<span class="number">2</span>),</span><br><span class="line">   age <span class="built_in">number</span>(<span class="number">2</span>),</span><br><span class="line">   birthday <span class="built_in">date</span> <span class="keyword">default</span> <span class="keyword">sysdate</span></span><br><span class="line"> )</span><br><span class="line"> /</span><br><span class="line">      </span><br><span class="line"><span class="comment">--2、修改学生表额外添加成绩字段。</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> Student</span><br><span class="line">  <span class="keyword">add</span> (grade <span class="built_in">number</span>(<span class="number">3</span>,<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">--2-1、给学号加上主键约束。</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> Student</span><br><span class="line">  <span class="keyword">add</span>  <span class="keyword">constraint</span> PK_Student_cno primary <span class="keyword">key</span> (cno);</span><br><span class="line"></span><br><span class="line"><span class="comment">--3、给性别加检查约束：提示 check(sex='男' or sex='女') 。</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> Student</span><br><span class="line">  <span class="keyword">add</span> <span class="keyword">constraint</span> CHK_Student_sex <span class="keyword">check</span> (sex <span class="keyword">in</span>(<span class="string">'男'</span>,<span class="string">'女'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">--4、年龄加检查约束，年龄在18~25之间；提示：check(age&gt;=18 and age&lt;=25)。</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> Student</span><br><span class="line">  <span class="keyword">add</span> <span class="keyword">constraint</span> CHK_Student_age <span class="keyword">check</span> (age <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--5、向表里插入记录来验证约束是否生效。</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> Student</span><br><span class="line">         <span class="keyword">values</span> (<span class="number">95009</span>,<span class="string">'\张三'</span>,<span class="string">'男'</span>,<span class="number">25</span>,<span class="built_in">date</span><span class="string">'2011-02-15'</span>,<span class="number">96</span>);</span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> Student</span><br><span class="line">         <span class="keyword">values</span> (<span class="number">95002</span>,<span class="string">'李四'</span>,<span class="string">'女'</span>,<span class="number">23</span>,<span class="built_in">date</span><span class="string">'2011-02-15'</span>,<span class="number">97</span>);</span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> Student</span><br><span class="line">         <span class="keyword">values</span> (<span class="number">95004</span>,<span class="string">'王五'</span>,<span class="string">'男'</span>,<span class="number">18</span>,<span class="built_in">date</span><span class="string">'2019-8-15'</span>,<span class="number">96</span>);</span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> Student</span><br><span class="line">         <span class="keyword">values</span> (<span class="number">95003</span>,<span class="string">'james'</span>,<span class="string">'女'</span>,<span class="number">22</span>,<span class="built_in">date</span><span class="string">'2019-8-15'</span>,<span class="number">96</span>);</span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> Student</span><br><span class="line">         <span class="keyword">values</span> (<span class="number">95005</span>,<span class="string">'andy'</span>,<span class="string">'男'</span>,<span class="number">18</span>,<span class="string">'9-12月-14'</span>,<span class="number">96</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--6、查询出表中的所有记录。</span></span><br><span class="line"><span class="keyword">select</span>　* <span class="keyword">from</span> Student;</span><br><span class="line"></span><br><span class="line"><span class="comment">--7. 查询出表中的所有记录。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--8. 选择部门为30中的所有员工</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott <span class="keyword">where</span>  deptno = <span class="number">30</span> ;</span><br><span class="line"><span class="comment">--9. 列出所有办事员（CLERK）的姓名，编号和部门编号</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> ename <span class="keyword">from</span> new_scott <span class="keyword">where</span> job=<span class="string">'CLERK'</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">--10. 找出佣金高于薪金的员工。</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott <span class="keyword">where</span> comm&gt;sal;</span><br><span class="line"></span><br><span class="line"><span class="comment">--11. 找出佣金高于薪金60%的员工</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott <span class="keyword">where</span> comm&gt;(sal*<span class="number">0.6</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--12. 找出部门10中所有的（MANAGER）和部门20中所有办事员（CLERK）。</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott </span><br><span class="line">       <span class="keyword">where</span> (deptno=<span class="number">10</span> <span class="keyword">and</span> job = <span class="string">'MANAGER'</span>)  <span class="keyword">or</span>   (deptno = <span class="number">20</span> <span class="keyword">and</span> job = <span class="string">'CLERK'</span>);</span><br><span class="line"><span class="comment">--插入信息    </span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">into</span> new_scott <span class="keyword">values</span>(<span class="number">7347</span>,<span class="string">'Bob'</span>,<span class="string">'CLERK'</span>,<span class="number">7876</span>,<span class="keyword">to_date</span>(<span class="string">'1999-02-15'</span>,<span class="string">'yyyy-mm-dd'</span>),<span class="number">1000</span>,<span class="number">0</span>,<span class="number">10</span>);</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott <span class="keyword">where</span> empno = <span class="string">'7347'</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;<span class="comment">--提交</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;<span class="comment">--回滚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--修改当前回话的日期格式</span></span><br><span class="line"><span class="comment">--alter session set sysdate_formate = 'YYYY-MM-DD  HH24:MI:SS';</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--更新</span></span><br><span class="line"><span class="keyword">update</span> new_scott </span><br><span class="line">       <span class="keyword">set</span> ename = <span class="string">'james'</span> <span class="keyword">where</span> empno = <span class="number">7347</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">--删除</span></span><br><span class="line"><span class="keyword">delete</span> new_scott</span><br><span class="line">  <span class="keyword">where</span> empno = <span class="number">7347</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--DCL ||||| commit:提交   rollback：回滚     savepoint ：表即可回滚的点</span></span><br><span class="line">      <span class="keyword">delete</span> new_scott <span class="keyword">where</span> ename = <span class="string">'JONES'</span>;</span><br><span class="line">      <span class="keyword">savepoint</span> mark1;</span><br><span class="line">      <span class="keyword">update</span> new_scott <span class="keyword">set</span> ename = <span class="string">'chengui'</span></span><br><span class="line">      <span class="keyword">where</span> empno = <span class="number">7369</span>;</span><br><span class="line">      <span class="keyword">savepoint</span> mark2;</span><br><span class="line">      <span class="keyword">rollback</span> <span class="keyword">to</span> <span class="keyword">savepoint</span> mark1;</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line"><span class="comment">--链接符||</span></span><br><span class="line">      <span class="keyword">select</span> empno||<span class="string">'姓名'</span>||ename||<span class="string">'工作'</span>||job||<span class="string">'上司'</span>||mgr||<span class="string">'入职时间'</span>||hiredate||<span class="string">'工资'</span>||sal||<span class="string">'佣金'</span>||comm||<span class="string">'部门编号'</span>||deptno <span class="keyword">from</span> new_scott;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="comment">--like 匹配</span></span><br><span class="line">   <span class="keyword">select</span> * <span class="keyword">from</span> new_scott</span><br><span class="line">   <span class="keyword">where</span> job <span class="keyword">like</span> <span class="string">'_A%'</span>;</span><br><span class="line">   <span class="keyword">select</span> * <span class="keyword">from</span> new_scott </span><br><span class="line">   <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">'\%'</span> ;</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">select</span> ename , sal,nvl(comm,<span class="number">0</span>),sal+nvl(comm,<span class="number">0</span>)  salary  <span class="keyword">from</span> new_scott;</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">select</span> * <span class="keyword">from</span> new_scott </span><br><span class="line">   <span class="keyword">where</span> mgr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br><span class="line">   </span><br><span class="line"><span class="comment">--13. 找出收取佣金的员工的不同工作</span></span><br><span class="line">      <span class="keyword">select</span> <span class="keyword">distinct</span> job <span class="keyword">from</span> new_scott </span><br><span class="line">      <span class="keyword">where</span> comm <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br><span class="line">      </span><br><span class="line"><span class="comment">--14. 找出不收取佣金或收取的佣金不低于100的员工</span></span><br><span class="line">      <span class="keyword">select</span> * <span class="keyword">from</span> new_scott  </span><br><span class="line">      <span class="keyword">where</span> comm <span class="keyword">is</span> <span class="literal">null</span> <span class="keyword">or</span> comm&lt;<span class="number">100</span></span><br><span class="line">      <span class="keyword">order</span> <span class="keyword">by</span> empno</span><br><span class="line"></span><br><span class="line"><span class="comment">--15. 找出部门10中所有的（MANAGER）和部门20中所有办事员（CLERK）,</span></span><br><span class="line"><span class="comment">--和既不是经理又不是办事员但其薪金大于或等于2000的所有员工的详细资料</span></span><br><span class="line">     <span class="keyword">select</span> * <span class="keyword">from</span> new_scott</span><br><span class="line">     <span class="keyword">where</span>  (deptno = <span class="number">10</span> <span class="keyword">and</span> job = <span class="string">'MANAGER'</span>  <span class="keyword">or</span> deptno = <span class="number">20</span>   <span class="keyword">AND</span> JOB = <span class="string">'CLERK'</span> )</span><br><span class="line">     <span class="keyword">OR</span> (JOB <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="string">'MANAGER'</span>,<span class="string">'CLERK'</span>) <span class="keyword">AND</span> SAL&gt;=<span class="number">2000</span>);                                                                                                                                    </span><br><span class="line">                                                                                                                                                  </span><br><span class="line"></span><br><span class="line"><span class="comment">--16. 找出各月倒数第三天受雇的所有员工</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">extract</span>(<span class="keyword">DAY</span> <span class="keyword">from</span> <span class="keyword">last_day</span>(hiredate))- <span class="keyword">extract</span>(<span class="keyword">DAY</span> <span class="keyword">from</span> (hiredate))=<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--17. 找出早于25年前受雇佣的员工</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott</span><br><span class="line">       <span class="keyword">where</span> <span class="keyword">extract</span>(<span class="keyword">year</span> <span class="keyword">from</span> systimestamp)- <span class="keyword">extract</span>(<span class="keyword">year</span> <span class="keyword">from</span> (hiredate))&gt;<span class="number">25</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--18. 以首字母大写其它字母小写的方式显示所有的员工的姓名。</span></span><br><span class="line"><span class="keyword">select</span> empno,INITCAP(<span class="keyword">LOWER</span>(ename)),job,mgr,hiredate,sal,comm,deptno <span class="keyword">from</span> new_scott;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--以首字母小写其它字母大写的方式显示所有的员工的姓名。</span></span><br><span class="line"> <span class="comment">--CONCAT(UPPER(substr(LOWER(ename),1,1))   ,  UPPER(substr(UPPER(ename),1)))</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> empno,<span class="keyword">CONCAT</span>((<span class="keyword">substr</span>(<span class="keyword">LOWER</span>(ename),<span class="number">1</span>,<span class="number">1</span>))   ,  <span class="keyword">UPPER</span>(<span class="keyword">substr</span>(<span class="keyword">UPPER</span>(ename),<span class="number">1</span>))),</span><br><span class="line">       job,mgr,hiredate,sal,comm,deptno <span class="keyword">from</span> new_scott;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--19. 显示正好为5字符的员工的姓名</span></span><br><span class="line"><span class="keyword">select</span> ename <span class="keyword">from</span> new_scott</span><br><span class="line">       <span class="keyword">where</span> <span class="keyword">LENGTH</span>(ename)=<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--20. 显示不带有‘R’的与员工的姓名</span></span><br><span class="line"><span class="keyword">select</span> ename <span class="keyword">from</span> new_scott</span><br><span class="line">       <span class="keyword">where</span>  ename <span class="keyword">not</span> <span class="keyword">like</span> <span class="string">'%R%'</span>;</span><br><span class="line"><span class="comment">--21. 显示所有员工姓名的前三个字符。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">SUBSTR</span>(ename,<span class="number">1</span>,<span class="number">3</span>) <span class="keyword">from</span> new_scott;</span><br><span class="line"></span><br><span class="line"><span class="comment">--22. 显示所有员工的姓名，用 A 替换 a </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">TRANSLATE</span>(ename,<span class="string">'A'</span>,<span class="string">'a'</span>)<span class="keyword">from</span> new_scott;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--23. 显示 满25年 服务年限的员工的姓名 和受雇日期</span></span><br><span class="line"><span class="keyword">select</span> ename,hiredate <span class="keyword">from</span> new_scott</span><br><span class="line">       <span class="keyword">where</span> <span class="keyword">extract</span>(<span class="keyword">year</span> <span class="keyword">from</span> systimestamp)- <span class="keyword">extract</span>(<span class="keyword">year</span> <span class="keyword">from</span> (hiredate))&gt;<span class="number">25</span>;</span><br><span class="line"><span class="comment">--MONTHS_BETWEEN(sysdate,hiredate)/12&gt;25;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--24. 显示员工的详细资料，按姓名排序,姓名相同按工资降序排序。</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> ename ,sal <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--25. 显示与员工的姓名和受雇日期，根据其服务年限，将最老的员工排在最前面。</span></span><br><span class="line"><span class="keyword">select</span> ename,hiredate , (<span class="keyword">extract</span>(<span class="keyword">year</span> <span class="keyword">from</span> systimestamp)- <span class="keyword">extract</span>(<span class="keyword">year</span> <span class="keyword">from</span> (hiredate))) <span class="keyword">time</span> <span class="keyword">from</span>  new_scott</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">time</span>  <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--26. 显示所有员工的姓名，工作和薪金，按工作的降序排序，若工作相同按薪金排序</span></span><br><span class="line"><span class="keyword">select</span> ename,job,sal <span class="keyword">from</span> new_scott</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> job <span class="keyword">desc</span>,sal <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--select * from new_scott;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--decode用法（条件，属性1，值1，属性2，值2，……，默认值）</span></span><br><span class="line">    <span class="keyword">select</span> ename,<span class="keyword">decode</span>(job,<span class="string">'CLERK'</span>,<span class="string">'办事员'</span>,<span class="string">'MANAGER'</span>,<span class="string">'经理'</span>,</span><br><span class="line">    <span class="string">'SALESMAN'</span>,<span class="string">'销售员'</span>,<span class="string">'ANALYST'</span>,<span class="string">'分析师'</span>,<span class="string">'老板'</span>) <span class="keyword">from</span> new_scott;</span><br><span class="line"><span class="comment">--27. 显示所有员工的姓名，加入公司的年份和月份，按受雇日期所在的月排序，若月份相同，则将最早的年份的员工排在最前面</span></span><br><span class="line"><span class="keyword">select</span> ename,to_char(hiredate,<span class="string">'yyyy"年"mm"月"'</span>) <span class="keyword">from</span> new_scott</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">extract</span>(<span class="keyword">MONTH</span> <span class="keyword">from</span> hiredate) ,<span class="keyword">extract</span>(<span class="keyword">YEAR</span> <span class="keyword">from</span> hiredate)</span><br><span class="line">;</span><br><span class="line"><span class="comment">--经典方法</span></span><br><span class="line"><span class="keyword">select</span> ename,job,TO_CHAR(hiredate,<span class="string">'yyyy'</span>)<span class="keyword">year</span>,to_char(hiredate,<span class="string">'mm'</span>)<span class="keyword">month</span>,<span class="keyword">form</span> employee <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">month</span>,<span class="keyword">year</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*-------------------------------------------------------- 分组查询 -------------------------------------*/</span></span><br><span class="line">		 </span><br><span class="line"><span class="comment">--28. 显示非销售人员工作名称以及从事同一工作雇员的月工资的总和，并且要满足从事同一工作的雇员的月工资合计大于$5000，</span></span><br><span class="line"><span class="comment">--输出结果按月工资排序。</span></span><br><span class="line"><span class="keyword">select</span> job,<span class="keyword">sum</span>(sal) <span class="keyword">from</span> new_scott</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> job</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">sum</span>(sal)&gt;<span class="number">5000</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">sum</span>(sal);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--29. 查询出各部门的部门编号以及各部门的总工资和平均工资。</span></span><br><span class="line"><span class="keyword">select</span>  deptno ,to_char(<span class="keyword">sum</span>(sal),<span class="string">'L999,999,999.00'</span>),to_char(<span class="keyword">avg</span>(sal),<span class="string">'L999,999,999.00'</span>)<span class="keyword">from</span> new_scott</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott;</span><br><span class="line"></span><br><span class="line"><span class="comment">--30. 按男生和女生统计JAVA和ORACLE成绩的总分和平均分？</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(JAVASCORE) <span class="keyword">AS</span> <span class="keyword">java</span>总成绩 ,<span class="keyword">AVG</span>(JAVASCORE) <span class="keyword">java</span>平均成绩,<span class="keyword">SUM</span>(ORACLESCORE)<span class="keyword">oracle</span>总成绩 ,<span class="keyword">AVG</span>(ORACLESCORE) <span class="keyword">Oracle</span>平均成绩 <span class="keyword">FROM</span> STUDENT2</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> GENDER ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--	1）	建表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> STUDENT2</span><br><span class="line">(</span><br><span class="line">  STUNO       <span class="built_in">CHAR</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="literal">null</span> primary <span class="keyword">key</span>,</span><br><span class="line">  STUNAME     VARCHAR2(<span class="number">20</span>),</span><br><span class="line">  GENDER      <span class="built_in">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">  JAVASCORE   <span class="built_in">INTEGER</span>,</span><br><span class="line">  ORACLESCORE <span class="built_in">INTEGER</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">--	2）	插入记录</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENT2 <span class="keyword">VALUES</span>(<span class="string">'1000'</span>,<span class="string">'JAMES'</span>,<span class="string">'男'</span>,<span class="number">88</span>,<span class="number">78</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENT2 <span class="keyword">VALUES</span>(<span class="string">'1001'</span>,<span class="string">'JACK'</span>,<span class="string">'男'</span>,<span class="number">86</span>,<span class="number">79</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENT2 <span class="keyword">VALUES</span>(<span class="string">'1002'</span>,<span class="string">'ANDY'</span>,<span class="string">'女'</span>,<span class="number">76</span>,<span class="number">78</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENT2 <span class="keyword">VALUES</span>(<span class="string">'1003'</span>,<span class="string">'SAMMY'</span>,<span class="string">'女'</span>,<span class="number">77</span>,<span class="number">76</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENT2 <span class="keyword">VALUES</span>(<span class="string">'1004'</span>,<span class="string">'frank'</span>,<span class="string">'男'</span>,<span class="number">88</span>,<span class="number">78</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENT2 <span class="keyword">VALUES</span>(<span class="string">'1005'</span>,<span class="string">'bob'</span>,<span class="string">'男'</span>,<span class="number">86</span>,<span class="number">79</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENT2 <span class="keyword">VALUES</span>(<span class="string">'1006'</span>,<span class="string">'july'</span>,<span class="string">'女'</span>,<span class="number">76</span>,<span class="number">78</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENT2 <span class="keyword">VALUES</span>(<span class="string">'1007'</span>,<span class="string">'mark'</span>,<span class="string">'女'</span>,<span class="number">77</span>,<span class="number">76</span>);</span><br><span class="line"><span class="comment">--	统计成绩</span></span><br><span class="line"><span class="keyword">select</span> stuno,stuname,javascore+oraclescore 总成绩,(javascore+oraclescore)/<span class="number">2</span>  平均成绩 <span class="keyword">from</span> STUDENT2</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 总成绩 <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> gender,<span class="keyword">sum</span>(javascore),<span class="keyword">avg</span>(javascore),<span class="keyword">sum</span>(oraclesore),<span class="keyword">avg</span>(oraclescore) <span class="keyword">form</span> student2 </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> gender;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> newdept</span><br><span class="line"><span class="keyword">as</span> <span class="keyword">select</span> * <span class="keyword">from</span> scott.dept;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> newdept;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott;</span><br><span class="line"><span class="comment">--全链接</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> newdept <span class="keyword">full</span> <span class="keyword">join</span> new_scott <span class="keyword">on</span> new_scott.deptno = newdept.deptno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> newdept <span class="keyword">left</span> <span class="keyword">join</span> new_scott <span class="keyword">on</span> new_scott.deptno = newdept.deptno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> newdept <span class="keyword">right</span> <span class="keyword">join</span> new_scott <span class="keyword">on</span> new_scott.deptno = newdept.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">--coalesce(expr1,expr2,expr3,....exprn)  NVL  同，前为空，则一直向后搜寻，最后默认为exprn</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> salgrade</span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> scott.salgrade;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.*</span><br><span class="line"> <span class="keyword">from</span> new_scott n, salgrade s</span><br><span class="line"> <span class="keyword">where</span> e.sal <span class="keyword">between</span> s.lowsal <span class="keyword">and</span>  s.hisal;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="string">'工号为：'</span>|| e.empno||<span class="string">'的员工的名字是'</span>||e.ename||<span class="string">'的上司是'</span>||temp.empno</span><br><span class="line">       ||temp.ename  <span class="keyword">from</span> new_scott e <span class="keyword">join</span> new_scott temp <span class="keyword">on</span> e.mgr = temp.empno;</span><br><span class="line"></span><br><span class="line"><span class="comment">--工资分类</span></span><br><span class="line"><span class="keyword">select</span> e.* ,f.* <span class="keyword">from</span> new_scott e <span class="keyword">join</span> salgrade f</span><br><span class="line"><span class="keyword">on</span> e.sal &gt;f.losal <span class="keyword">and</span> e.sal&lt; f.hisal;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_salgrade_insert</span><br><span class="line"><span class="keyword">after</span> <span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> salgrade </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     RAISE_APPLICATION_ERROR (<span class="string">'YOU MAY ERRROR'</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="keyword">INSERT</span>  <span class="keyword">into</span> salgrade </span><br><span class="line"> <span class="keyword">values</span>(<span class="number">6</span>,<span class="number">4000</span>,<span class="number">9999</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">--查询在‘NEW YORK’工作，工资高于2000的员工以及员工的工资等级。</span></span><br><span class="line"><span class="comment">--方法一：</span></span><br><span class="line"><span class="keyword">select</span> n.*,s.grade ,dept.*</span><br><span class="line"> <span class="keyword">from</span> new_scott n , salgrade s,newdept dept</span><br><span class="line"> <span class="keyword">where</span> n.deptno = dept.deptno <span class="keyword">and</span> n.sal&gt;s.losal <span class="keyword">and</span> n.sal&lt;s.hisal <span class="keyword">and</span> n.sal&gt;<span class="number">2000</span> <span class="keyword">and</span> dept.loc = <span class="string">'NEW YORK'</span></span><br><span class="line"><span class="comment">--方法二：</span></span><br><span class="line"><span class="keyword">select</span> n.*,s.grade,dept.*</span><br><span class="line"><span class="keyword">from</span> new_scott n <span class="keyword">join</span> salgrade s</span><br><span class="line"><span class="keyword">on</span> n.sal&gt;s.losal <span class="keyword">and</span> n.sal&lt;s.hisal</span><br><span class="line"><span class="keyword">join</span> newdept dept</span><br><span class="line"><span class="keyword">on</span> dept.deptno = n.deptno <span class="keyword">and</span> n.sal&gt;<span class="number">2000</span> <span class="keyword">and</span> dept.loc <span class="keyword">like</span> <span class="string">'NEW YORK'</span>;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> n.empno,n.ename,sal,loc</span><br><span class="line"><span class="keyword">from</span> new_scott n, (<span class="keyword">select</span> * <span class="keyword">from</span> newdept <span class="keyword">where</span> newdept.loc = <span class="string">'NEW YORK'</span> <span class="keyword">and</span> deptno = <span class="number">10</span> ) S         </span><br><span class="line"><span class="keyword">where</span> n.deptno = s.deptno;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> newdept;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> NEW_SCOTT;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> newdept;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*-----------------------------------------------第三章 高级查询  --------------------------------</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--A. 查询部门在‘NEW YORK’工资低于4000，不是‘CLERK’的员工？</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--B. 查询部门在‘CHICAGO’，在1981年入职，工资在2000~4000的员工？</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">/*----------------------------------------------- 子查询 -----------------------------------------</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">子查询注意的问题：</span></span><br><span class="line"><span class="comment">	1、要将子查询发在圆括号内。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	2、子查询可出现在WHERE子句、FROM子句、SELECT列表(此处只能是一个单行子查询)、HAVING子句中。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	3、子查询不能出现在主查询的GROUP BY语句中。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	4、子查询和主查询使用表可以不同，是要子查询返回的结果能够被主查询使用即可。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	5、一般不会在子查询中使用ORDER BY语句，但在TOP-N(只需前几条记录)分析中必须使用ORDER BY语句。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	6、单行子查询只能使用单行操作符，多行子查询只能使用多行操作符。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	7、采用合理的缩进和换行来提过SQL语句的可读性。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	8、子查询中的空值问题。</span></span><br><span class="line"><span class="comment">*/</span>	</span><br><span class="line"></span><br><span class="line"><span class="comment">--31. 查询部门名称为SALES和ACCOUNTING的员工信息</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1	7499	ALLEN	SALESMAN	7698	1981/2/20	1600.00	300.00	30	30	SALES	CHICAGO</span></span><br><span class="line"><span class="comment">2	7521	WARD	SALESMAN	7698	1981/2/22	1250.00	500.00	30	30	SALES	CHICAGO</span></span><br><span class="line"><span class="comment">3	7654	MARTIN	SALESMAN	7698	1981/9/28	1250.00	1400.00	30	30	SALES	CHICAGO</span></span><br><span class="line"><span class="comment">4	7698	BLAKE	MANAGER	7839	1981/5/1	2850.00		30	30	SALES	CHICAGO</span></span><br><span class="line"><span class="comment">5	7782	CLARK	MANAGER	7839	1981/6/9	2450.00		10	10	ACCOUNTING	NEW YORK</span></span><br><span class="line"><span class="comment">6	7839	KING	PRESIDENT		1981/11/17	5000.00		10	10	ACCOUNTING	NEW YORK</span></span><br><span class="line"><span class="comment">7	7844	TURNER	SALESMAN	7698	1981/9/8	1500.00	0.00	30	30	SALES	CHICAGO</span></span><br><span class="line"><span class="comment">8	7900	JAMES	CLERK	7698	1981/12/3	950.00		30	30	SALES	CHICAGO</span></span><br><span class="line"><span class="comment">9	7934	MILLER	CLERK	7782	1982/1/23	1300.00		10	10	ACCOUNTING	NEW YORK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott e,newdept n</span><br><span class="line"><span class="keyword">where</span> e.deptno = n.deptno <span class="keyword">and</span> n.dname <span class="keyword">in</span> (<span class="string">'SALES'</span>,<span class="string">'ACCOUNTING'</span>);</span><br><span class="line">			  </span><br><span class="line">      </span><br><span class="line"><span class="comment">--32. 查询不是经理的员工的信息(使用in 或 not in来做)</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1	7369	SMITH	CLERK	7902	1980/12/17	800.00		20</span></span><br><span class="line"><span class="comment">2	7499	ALLEN	SALESMAN	7698	1981/2/20	1600.00	300.00	30</span></span><br><span class="line"><span class="comment">3	7521	WARD	SALESMAN	7698	1981/2/22	1250.00	500.00	30</span></span><br><span class="line"><span class="comment">4	7654	MARTIN	SALESMAN	7698	1981/9/28	1250.00	1400.00	30</span></span><br><span class="line"><span class="comment">5	7844	TURNER	SALESMAN	7698	1981/9/8	1500.00	0.00	30</span></span><br><span class="line"><span class="comment">6	7876	ADAMS	CLERK	7788	1987/5/23	1100.00		20</span></span><br><span class="line"><span class="comment">7	7900	JAMES	CLERK	7698	1981/12/3	950.00		30</span></span><br><span class="line"><span class="comment">8	7934	MILLER	CLERK	7782	1982/1/23	1300.00		10</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> <span class="keyword">select</span> * <span class="keyword">from</span> new_scott </span><br><span class="line"> <span class="keyword">where</span> empno <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> mgr <span class="keyword">from</span> new_scott <span class="keyword">where</span> mgr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--33. 查询工资比10号部门员工中任意一个低的员工信息(13)</span></span><br><span class="line"> <span class="keyword">select</span> * <span class="keyword">from</span> new_scott e</span><br><span class="line"> <span class="keyword">where</span> e.sal &lt; <span class="keyword">any</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> sal <span class="keyword">from</span> new_scott <span class="keyword">where</span> deptno = <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--34. 查询工资比10号部门都要低的员工信息</span></span><br><span class="line"> <span class="keyword">select</span> * <span class="keyword">from</span> new_scott e</span><br><span class="line"> <span class="keyword">where</span> e.sal &lt;all (<span class="keyword">select</span> <span class="keyword">distinct</span> sal <span class="keyword">from</span> new_scott <span class="keyword">where</span> deptno = <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--35. 查询出部门名称，部门员工数，部门平均工资，部门最低工资雇员的姓名，及工资等级</span></span><br><span class="line"><span class="keyword">select</span> n.dname,t.deptno,t.total,t.ag,t.mi,s.grade,e.ename</span><br><span class="line"><span class="keyword">from</span> new_scott e ,salgrade s,newdept n,(<span class="keyword">select</span> deptno, <span class="keyword">count</span>(*) total, <span class="keyword">avg</span>(sal) ag, <span class="keyword">min</span>(sal) mi  <span class="keyword">from</span> new_scott  <span class="keyword">group</span> <span class="keyword">by</span> deptno) t</span><br><span class="line"><span class="keyword">where</span> e.deptno = t.deptno </span><br><span class="line">      <span class="keyword">and</span> e.sal&gt;=s.losal </span><br><span class="line">      <span class="keyword">and</span> e.sal&lt;=s.hisal</span><br><span class="line">      <span class="keyword">and</span> n.deptno = e.deptno</span><br><span class="line">      <span class="keyword">and</span> e.sal <span class="keyword">in</span> (<span class="keyword">select</span> mi <span class="keyword">from</span> (<span class="keyword">select</span> deptno, <span class="keyword">count</span>(*) total, <span class="keyword">avg</span>(sal) ag, <span class="keyword">min</span>(sal) mi  <span class="keyword">from</span> new_scott  <span class="keyword">group</span> <span class="keyword">by</span> deptno) t)</span><br><span class="line">   </span><br><span class="line"><span class="comment">--36. 列出最低薪金大于1500的各种工作及此从事此工作的全部雇员人数</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1	ANALYST	2</span></span><br><span class="line"><span class="comment">2	MANAGER	3</span></span><br><span class="line"><span class="comment">3	PRESIDENT	1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">--方法一</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span>(e.job),t.total</span><br><span class="line"><span class="keyword">from</span> new_scott e,(<span class="keyword">select</span> job ,<span class="keyword">min</span>(sal) mi,<span class="keyword">count</span>(*) total <span class="keyword">from</span> new_scott <span class="keyword">group</span> <span class="keyword">by</span> job)t</span><br><span class="line"><span class="keyword">where</span> e.job  = t.job  </span><br><span class="line">  <span class="keyword">and</span> t.mi &gt; <span class="number">1500</span>;</span><br><span class="line"><span class="comment">--方法二</span></span><br><span class="line"><span class="keyword">select</span> e.job, <span class="keyword">count</span>(*)人数</span><br><span class="line">       <span class="keyword">from</span></span><br><span class="line">       emp e</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> e.job <span class="keyword">having</span> (<span class="keyword">select</span> <span class="keyword">min</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> e.em)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--37. 求出在'salesman'部门工作的员工姓名，假设不知道销售部的部门编号</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> e.ename <span class="keyword">from</span> new_scott e,newdept n</span><br><span class="line"><span class="keyword">where</span> e.deptno = (<span class="keyword">select</span> <span class="keyword">distinct</span> deptno <span class="keyword">from</span> new_scott <span class="keyword">where</span> job = <span class="keyword">UPPER</span>(<span class="string">'salesman'</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--38. 列出薪金高于公司平均薪金的所有员工，所在部门，上级领导，公司的工资等级</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.ename,e.sal,n.dname,e.mgr,s.grade</span><br><span class="line"><span class="keyword">from</span> new_scott e,newdept n,salgrade s</span><br><span class="line"><span class="keyword">where</span> e.sal &gt;(<span class="keyword">select</span> <span class="keyword">avg</span>(sal) <span class="keyword">from</span> new_scott )</span><br><span class="line"><span class="keyword">and</span> e.deptno = n.deptno</span><br><span class="line"><span class="keyword">and</span> e.sal &gt;s.losal <span class="keyword">and</span> e.sal &lt;=s.hisal;</span><br><span class="line"></span><br><span class="line"><span class="comment">--39. 列出于“SCOTT”从事相同工作的所有员工及部门名称</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.ename ,n.dname </span><br><span class="line"><span class="keyword">from</span> new_scott e,newdept n</span><br><span class="line"><span class="keyword">where</span> e.job = (<span class="keyword">select</span> job <span class="keyword">from</span> new_scott <span class="keyword">where</span> ename = <span class="string">'SCOTT'</span>)</span><br><span class="line">            <span class="keyword">and</span> e.deptno = n.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">--40. 查询和SMITH部门相同 岗位相同的人</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott e, newdept n</span><br><span class="line"><span class="keyword">where</span> e.deptno = (<span class="keyword">select</span> deptno <span class="keyword">from</span> new_scott <span class="keyword">where</span> ename = <span class="string">'SMITH'</span> )</span><br><span class="line">      <span class="keyword">and</span> e.job = (<span class="keyword">select</span> job <span class="keyword">from</span> new_scott <span class="keyword">where</span> ename = <span class="string">'SMITH'</span>)</span><br><span class="line">      <span class="keyword">and</span> e.deptno = n.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">--41. 和ALLEN同部门，工资高于MARTIN的雇员有哪些</span></span><br><span class="line">      <span class="keyword">select</span> * <span class="keyword">from</span> new_scott e</span><br><span class="line">      <span class="keyword">where</span> e.deptno = (<span class="keyword">select</span> deptno <span class="keyword">from</span> new_scott <span class="keyword">where</span> ename = <span class="string">'ALLEN'</span>)</span><br><span class="line">      <span class="keyword">and</span> e.sal &gt; (<span class="keyword">select</span> sal <span class="keyword">from</span> new_scott <span class="keyword">where</span> ename = <span class="string">'ALLEN'</span>)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">--42. 比blake工资高的雇员有哪些? </span></span><br><span class="line">  <span class="keyword">select</span> * <span class="keyword">from</span> new_scott e</span><br><span class="line">  <span class="keyword">where</span> e.sal &gt; (<span class="keyword">select</span> sal <span class="keyword">from</span> new_scott <span class="keyword">where</span> ename = <span class="keyword">upper</span>(<span class="string">'blake'</span>))</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--43. 高于30部门最高工资的雇员有哪些?</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott e</span><br><span class="line">  <span class="keyword">where</span> e.sal &gt; (<span class="keyword">select</span> <span class="keyword">max</span>(sal) <span class="keyword">from</span> new_scott <span class="keyword">where</span> deptno = <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--44. 查询scott用户下的emp表中所有的经理的信息(此操作子查询会返回多行记录)</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> new_scott </span><br><span class="line"><span class="keyword">where</span> empno <span class="keyword">in</span> (<span class="keyword">select</span> mgr <span class="keyword">from</span> new_scott);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--45. 工资高于本部门平均工资的人（拿上游工资的人）有哪些？****</span></span><br><span class="line"><span class="keyword">select</span> e.*</span><br><span class="line"><span class="keyword">from</span> new_scott e</span><br><span class="line"><span class="keyword">where</span> e.sal &gt;(<span class="keyword">select</span> <span class="keyword">avg</span>(sal) <span class="keyword">from</span> new_scott <span class="keyword">where</span> deptno = e.deptno)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.deptno ,e.empno,e.sal,e.ename <span class="keyword">from</span> new_scott e,(<span class="keyword">select</span> deptno,<span class="keyword">avg</span>(sal) ag <span class="keyword">from</span> new_scott <span class="keyword">group</span> <span class="keyword">by</span> deptno ) t</span><br><span class="line"><span class="keyword">where</span> t.deptno = e.deptno <span class="keyword">and</span> e.sal &gt; t.ag</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> e.deptno ,e.empno,e.ename,e.sal;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--46. 工作和部门与SMITH相同，工资高于JAMES的雇员有哪些?</span></span><br><span class="line"><span class="keyword">select</span>  * <span class="keyword">from</span> new_scott e,newdept n</span><br><span class="line"><span class="keyword">where</span> e.job = (<span class="keyword">select</span> job  <span class="keyword">from</span> new_scott <span class="keyword">where</span> ename = <span class="string">'SMITH'</span>)</span><br><span class="line">    <span class="keyword">and</span> e.deptno = n.deptno</span><br><span class="line">    <span class="keyword">and</span> n.deptno = (<span class="keyword">select</span> new_scott.deptno <span class="keyword">from</span> new_scott,newdept  <span class="keyword">where</span> ename = <span class="string">'SMITH'</span> <span class="keyword">and</span> new_scott.deptno = newdept.deptno )</span><br><span class="line">    <span class="keyword">and</span> e.sal &gt;(<span class="keyword">select</span> sal <span class="keyword">from</span> new_scott <span class="keyword">where</span> ename = <span class="string">'JAMES'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*---------------------------------------------- 多行子查询 --------------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--47. 列出薪金等于部门30中员工的薪金的所有员工的姓名和薪金</span></span><br><span class="line"><span class="keyword">select</span> e.ename,e.sal <span class="keyword">from</span> new_scott e</span><br><span class="line"><span class="keyword">where</span> e.sal <span class="keyword">in</span> (<span class="keyword">select</span> sal <span class="keyword">from</span> new_scott <span class="keyword">where</span> deptno = <span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--48.列出薪金大于部门30中员工的薪金的所有员工的姓名和薪金</span></span><br><span class="line"><span class="keyword">select</span> e.ename,e.sal <span class="keyword">from</span> new_scott e</span><br><span class="line"><span class="keyword">where</span> e.sal&gt;<span class="keyword">any</span> (<span class="keyword">select</span> sal <span class="keyword">from</span> new_scott <span class="keyword">where</span> deptno = <span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--49.列出每个部门工作的员工数量，平均工资和平均服务年限</span></span><br><span class="line"><span class="keyword">select</span> deptno ,<span class="keyword">count</span>(*) 员工数量 ,to_char(<span class="keyword">avg</span> (sal),<span class="string">'L999,999.00'</span>),to_char(<span class="keyword">avg</span>(months_between(<span class="keyword">sysdate</span>,hiredate)/<span class="number">12</span>),<span class="string">'999.00'</span>) <span class="keyword">from</span> new_scott</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> new_scott e,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--删除没有员工的部门</span></span><br><span class="line"><span class="comment">--方法一</span></span><br><span class="line"><span class="keyword">delete</span> newdept</span><br><span class="line"><span class="keyword">where</span> deptno <span class="keyword">in</span> (<span class="keyword">select</span> deptno <span class="keyword">from</span> newdept <span class="keyword">MINUS</span> <span class="keyword">select</span> <span class="keyword">distinct</span> deptno <span class="keyword">from</span> new_scott)<span class="keyword">and</span> deptno &lt;&gt; <span class="number">40</span>;</span><br><span class="line"><span class="comment">--方法二</span></span><br><span class="line"><span class="keyword">delete</span> newdept</span><br><span class="line"><span class="keyword">where</span> deptno <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> deptno <span class="keyword">from</span> new_scott)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--创建同义词：</span></span><br><span class="line"><span class="comment">-- 1)创建私有同义词   注意：需要sys授权：grant create SYNONYM to stu;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">public</span> <span class="keyword">synonym</span> emp <span class="keyword">for</span> new_scott ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2）创建共有同义词  注意：需要sys授权：grant create public SYNONYM to stu;</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">public</span> <span class="keyword">synonym</span> dept1 <span class="keyword">for</span> newdept;</span><br><span class="line"><span class="comment">--drop public synonym dept;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--创建序列：</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">sequence</span> emp_seq</span><br><span class="line">       <span class="keyword">start</span> <span class="keyword">with</span> <span class="number">8002</span></span><br><span class="line">       <span class="keyword">increment</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">       <span class="keyword">minvalue</span> <span class="number">8002</span></span><br><span class="line">       maxvalue <span class="number">999999999999</span></span><br><span class="line">       <span class="keyword">cycle</span></span><br><span class="line">       <span class="keyword">cache</span> <span class="number">20</span></span><br><span class="line"><span class="comment">--select emp_seq.nextval from emp_seq;--执行emp_seq.currval 之前一定要执行一次 emp_seq.nextval</span></span><br><span class="line"><span class="keyword">select</span> emp_seq.currval <span class="keyword">from</span> dual;</span><br><span class="line">       <span class="keyword">commit</span>;</span><br><span class="line">       <span class="keyword">drop</span> <span class="keyword">sequence</span> emp_seq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(empno,ename,job,mgr,deptno)</span><br><span class="line"><span class="keyword">values</span>(emp_seq.nextval ,<span class="string">'james'</span>,<span class="string">'CLERK'</span>,<span class="number">7698</span>,<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建视图</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> emp_view</span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line">   <span class="keyword">select</span> * <span class="keyword">from</span> emp;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp_view;</span><br><span class="line"><span class="comment">--删除视图</span></span><br><span class="line"><span class="keyword">drop</span>  <span class="keyword">view</span> emp_view;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> empno,ename,dname <span class="keyword">from</span> emp e,newdept d <span class="keyword">where</span> e.deptno = d.deptno <span class="keyword">AND</span> e.ename&lt;&gt;<span class="string">'SCOTT'</span> <span class="keyword">AND</span> e.job=(<span class="keyword">select</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> ename=<span class="string">'SCOTT'</span>);</span><br><span class="line"><span class="comment">--创建索引</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">index</span> emp_job <span class="keyword">on</span> emp(job);</span><br><span class="line"><span class="comment">--验证索引</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> job = <span class="keyword">upper</span>(<span class="string">'salesman'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--第一个小例子</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   dbms_output.put_line(<span class="string">'最简单的PL/SQL'</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">    v_money <span class="built_in">number</span>(<span class="number">4</span>,<span class="number">1</span>) := <span class="number">2.3</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     dbms_output.put_line(v_money);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--第二个小例子</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">   v_ename VARCHAR2(<span class="number">20</span>); 			   <span class="comment">--运行时在输入</span></span><br><span class="line">   v_ename2 v_ename%type;			   <span class="comment">--引用另一个变量的类型</span></span><br><span class="line">   v_empno NUMBER(4) not null := 7999; <span class="comment">--初始化</span></span><br><span class="line">   v_empno2 NUMBER(4);  			   <span class="comment">--运行时在输入</span></span><br><span class="line">   v_job emp.job%type; 		   <span class="comment">--变量与job列的数据类型和宽度一致</span></span><br><span class="line">   v_hiredate emp.hiredate%type default sysdate; <span class="comment">--赋默认值</span></span><br><span class="line">   v_sal CONSTANT emp.sal%type := 3000; 		  <span class="comment">--常量</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">     <span class="comment">--赋值方式 1：</span></span><br><span class="line">     v_ename := <span class="string">'&amp;请输入员工姓名：'</span>; <span class="comment">--&amp;号表示一个替代变量，可在运行时输入值，字符串需用单引号括起来</span></span><br><span class="line">     v_empno2 := &amp;请输入员工编号;</span><br><span class="line">     </span><br><span class="line">     <span class="comment">--赋值方式 2： select 列名列表 into 变量列表（对号入座）</span></span><br><span class="line">	   <span class="comment">--但是要注意现在给变量赋值不能返回多行，要处理多行的查询结果需要用到游标</span></span><br><span class="line">     <span class="keyword">SELECT</span> job <span class="keyword">INTO</span> v_job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empno=v_empno2; <span class="comment">--8001</span></span><br><span class="line"></span><br><span class="line">    dbms_output.put_line('员工编号:'||v_empno2||', 员工姓名：'||v_ename||', 职务：'||v_job||', 入职时间：'||v_hiredate);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--更新方式(emp 为  new_scott 的同义词 synonym)</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">      v_empno emp.empno%<span class="keyword">TYPE</span>;</span><br><span class="line">      v_ename emp.ename%TYPE;</span><br><span class="line">      v_sal   emp.sal  %TYPE;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">      v_empno:=&amp;员工工号;</span><br><span class="line">      <span class="keyword">select</span> ename,sal <span class="keyword">into</span> v_ename,v_sal <span class="keyword">from</span> emp <span class="keyword">where</span> emp.empno = v_empno;</span><br><span class="line">      dbms_output.put_line(v_empno||'   的名字是：'||v_ename||'    薪水是：'||v_sal);</span><br><span class="line">      if v_sal &lt; 3000 then</span><br><span class="line">      <span class="keyword">update</span> emp </span><br><span class="line">             <span class="keyword">set</span> sal = sal +<span class="number">500</span> <span class="keyword">where</span> empno  = v_empno;</span><br><span class="line">             dbms_output.put_line(v_ename||'加薪完成！');</span><br><span class="line">      else</span><br><span class="line">			       dbms_output.put_line('薪水已经很高了！');</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">if</span>;  </span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--IF-ELSE案例</span></span><br><span class="line"><span class="comment">--create or replace procedure emp_add_sal</span></span><br><span class="line"><span class="comment">--is</span></span><br><span class="line">     <span class="comment">-- begin </span></span><br><span class="line">      <span class="keyword">declare</span> </span><br><span class="line">         v_empno emp.empno%</span><br><span class="line">         rec_emp emp%rowtype;</span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">         v_empno := &amp;员工编号;</span><br><span class="line">         <span class="comment">--更新前</span></span><br><span class="line">         <span class="keyword">select</span> * <span class="keyword">into</span> rec_emp <span class="keyword">from</span> emp <span class="keyword">where</span> empno = v_empno;</span><br><span class="line">         dbms_output.put_line('更新前：员工编号：'||rec_emp.empno||', 员工名字：'||rec_emp.ename||'， 员工工资：'||rec_emp.sal);</span><br><span class="line">               if(rec_emp.sal&lt;3000) then</span><br><span class="line">                    <span class="keyword">update</span> emp <span class="keyword">set</span> sal = sal<span class="number">-500</span> <span class="keyword">where</span> empno = v_empno;</span><br><span class="line">               else</span><br><span class="line">                    <span class="keyword">update</span> emp <span class="keyword">set</span> sal = sal<span class="number">-200</span> <span class="keyword">where</span> empno = v_empno;</span><br><span class="line">               <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">        <span class="comment">-- commit;</span></span><br><span class="line">        <span class="comment">--更新后</span></span><br><span class="line">        <span class="keyword">select</span> * <span class="keyword">into</span> rec_emp <span class="keyword">from</span> emp <span class="keyword">where</span> empno = v_empno;</span><br><span class="line">         dbms_output.put_line('更新后：员工编号：'||rec_emp.empno||', 员工名字：'||rec_emp.ename||'， 员工工资：'||rec_emp.sal);</span><br><span class="line">        <span class="comment">--处理没有找到数据的异常</span></span><br><span class="line">           exception </span><br><span class="line">                 when NO_DATA_FOUND   THEN</span><br><span class="line">                       dbms_output.put_line('查无此人！');</span><br><span class="line">                 when others then</span><br><span class="line">                       dbms_output.put_line('错误代码：'||SQLCODE  ||',错误信息：'||SQLERRM);</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line"><span class="comment">--end emp_add_sal;</span></span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">--drop procedure emp_add_sal;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--CASE_WHEN</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ---------------------------------------第五章 PL/SQL 作业-----------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--A. 使用LOOP循环求1-100之间的素数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">50. 打印99乘法表</span></span><br><span class="line"><span class="comment">	1*1=1</span></span><br><span class="line"><span class="comment">	2*1=2 2*2=4</span></span><br><span class="line"><span class="comment">	3*1=3 3*2=6 3*3=9</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--第一种方式</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">   v_score <span class="built_in">integer</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   v_score:= &amp;成绩;</span><br><span class="line">   case </span><br><span class="line">        when v_score &gt;=80 then</span><br><span class="line">             dbms_output.put_line('优秀');</span><br><span class="line">        when v_score &gt;=70and v_score&lt;80 then</span><br><span class="line">             dbms_output.put_line('良好');</span><br><span class="line">        when v_score &gt;=60 and v_score &lt;70 then</span><br><span class="line">             dbms_output.put_line('一般');</span><br><span class="line">        else</span><br><span class="line">            dbms_output.put_line('不及格');  </span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">case</span>; </span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--第二种方式</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">   v_grade <span class="built_in">char</span>(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">case</span> <span class="string">'&amp;grade'</span>  <span class="comment">-- 此处一定注意：如果是字符型一定要加上   ''   否者报错，，，如果是数值型则不需要加 ’‘  </span></span><br><span class="line">          <span class="keyword">when</span> <span class="string">'A'</span>  <span class="keyword">then</span></span><br><span class="line">             dbms_output.put_line(<span class="string">'优秀'</span>);</span><br><span class="line">          when 'B' then</span><br><span class="line">             dbms_output.put_line('良好');</span><br><span class="line">          when 'C' then</span><br><span class="line">             dbms_output.put_line('一般');</span><br><span class="line">          else</span><br><span class="line">             dbms_output.put_line('不及格');</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">case</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--循环</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">  v_row <span class="built_in">int</span>:= &amp;行数;</span><br><span class="line">  v_counter1 int :=1;</span><br><span class="line">  v_counter2 int :=1;</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">      <span class="keyword">loop</span></span><br><span class="line">          v_counter1 := <span class="number">1</span>;</span><br><span class="line">          loop</span><br><span class="line">              dbms_output.put('*');</span><br><span class="line">              exit when v_counter1=v_counter2;</span><br><span class="line">              v_counter1:=v_counter1+1;</span><br><span class="line">          <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">          dbms_output.new_line;</span><br><span class="line">          v_counter2:=v_counter2+1;</span><br><span class="line">          exit when v_counter2 = v_row;</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--使用LOOP循环求1-100之间的素数</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">   v_prime <span class="built_in">int</span> :=<span class="number">2</span>;</span><br><span class="line">   v_counter int default 1;</span><br><span class="line">   counter int default 0;</span><br><span class="line">   num int default 0;<span class="comment">--统计个数</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">loop</span> </span><br><span class="line">          counter:=<span class="number">0</span>;<span class="comment">--计数器（每次重新开始）</span></span><br><span class="line">          v_counter:=2;<span class="comment">--除数 从 2~v_prime 除（每次重新开始）</span></span><br><span class="line">          loop</span><br><span class="line">              if v_prime mod v_counter = 0 then</span><br><span class="line">                 counter:=counter+1;</span><br><span class="line">              <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">              </span><br><span class="line">              exit when v_counter = v_prime  or counter &gt; 2;  --内循环结束条件  （2个条件满足一个即可跳出循环）</span><br><span class="line">                   v_counter:=v_counter+1;<span class="comment">--除数自加</span></span><br><span class="line">          <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">          </span><br><span class="line">          if counter = 1  then<span class="comment">--输出语句</span></span><br><span class="line">          num:= num+1;</span><br><span class="line">             if num&lt;&gt;1 then</span><br><span class="line">                dbms_output.put(',');</span><br><span class="line">             <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">             dbms_output.put(v_prime);</span><br><span class="line">          <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">          </span><br><span class="line">          exit when v_prime=100;<span class="comment">--外循环结束条件</span></span><br><span class="line">          v_prime:= v_prime+1;<span class="comment">--外循环自加</span></span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">     dbms_output.new_line;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--九九乘法表</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">        counter1 <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">1</span>;</span><br><span class="line">        counter2 int default 1;</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line">        counter1 :=&amp;乘法表范围;</span><br><span class="line">      for i in 1..9 loop</span><br><span class="line">          for j in 1..i loop</span><br><span class="line">               dbms_output.put(i||'*'||j||'='||i*j);</span><br><span class="line">               if(j&lt;&gt;i)then dbms_output.put(',');</span><br><span class="line">               <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">          <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">      dbms_output.new_line;</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">--52.使用FOR循环求1-100之间的素数</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">       counter <span class="built_in">int</span> :=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">2.</span><span class="number">.100</span> <span class="keyword">loop</span></span><br><span class="line">         counter:=<span class="number">0</span>;</span><br><span class="line">         for j in 2..i loop</span><br><span class="line">             if mod(i,j)=0 then </span><br><span class="line">                counter:=counter+1;</span><br><span class="line">                <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">         exit when counter &gt;1;</span><br><span class="line">         <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">         if counter = 1 then</span><br><span class="line">             dbms_output.put(i||',');</span><br><span class="line">          <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">     dbms_output.new_line;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">练习：</span></span><br><span class="line"><span class="comment">根据部门名称，按以下格式打印"RESEARCH"部门所有人员姓名：</span></span><br><span class="line"><span class="comment">	部门名称：RESEARCH</span></span><br><span class="line"><span class="comment">	部门人员：SMITH,JONES,FORD</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">    counter <span class="built_in">int</span> ;  </span><br><span class="line">    v_ename emp.ename%type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     dbms_output.put_line(<span class="string">'部门名称：'</span>||<span class="string">'RESEARCH'</span>);</span><br><span class="line">     dbms_output.put('部门人员：');</span><br><span class="line">     <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> counter <span class="keyword">from</span> emp e,newdept n  <span class="comment">--统计有多少个符合条件的</span></span><br><span class="line">     <span class="keyword">where</span> e.deptno = n.deptno</span><br><span class="line">           <span class="keyword">and</span> n.dname = <span class="string">'RESEARCH'</span>;</span><br><span class="line">           </span><br><span class="line">     for i in 1..counter loop  <span class="comment">--由于每次只能打印一个，所以用for循环</span></span><br><span class="line">         <span class="keyword">select</span> ename <span class="keyword">into</span> v_ename <span class="keyword">from</span></span><br><span class="line">         (</span><br><span class="line">          <span class="keyword">select</span> <span class="keyword">rownum</span> r,ename  <span class="comment">--用伪列rownum 为每一个符合的条件做个编号，以便输出</span></span><br><span class="line">                  <span class="keyword">from</span> emp e <span class="keyword">join</span> newdept n</span><br><span class="line">                  <span class="keyword">on</span> e.deptno = n.deptno</span><br><span class="line">                  <span class="keyword">and</span> n.dname = <span class="string">'RESEARCH'</span></span><br><span class="line">         )a</span><br><span class="line">         <span class="keyword">where</span> a.r = i;  </span><br><span class="line">         dbms_output.put(v_ename);</span><br><span class="line">         if i&lt;&gt;counter then</span><br><span class="line">            dbms_output.put(',');</span><br><span class="line">         <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">     dbms_output.new_line();</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--51. 根据工资查询员工姓名。如果此员工不存在（发出NO_DATA_FOUND异常），则打印相应的提示信息。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">   v_sal emp.sal%<span class="keyword">type</span>;</span><br><span class="line">   v_ename emp.ename%type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   v_sal := &amp;请输入工资;</span><br><span class="line">   <span class="keyword">select</span> ename <span class="keyword">into</span> v_ename <span class="keyword">from</span> emp</span><br><span class="line">          <span class="keyword">where</span> sal = v_sal;</span><br><span class="line">   dbms_output.put_line('工资为：'||v_sal||'的员工姓名是：'||v_ename);</span><br><span class="line">   exception</span><br><span class="line">     when NO_DATA_FOUND then</span><br><span class="line">          dbms_output.put_line('查无此人！');</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">---自定义异常</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">   v_empno emp.empno%<span class="keyword">type</span>:=&amp;加薪员工的工号;</span><br><span class="line">   v_count int default 0;</span><br><span class="line">   v_sal emp.sal%type;</span><br><span class="line">   invlite_sal exception;<span class="comment">--自定义异常</span></span><br><span class="line">   no_found exception;   <span class="comment">--自定义异常</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     v_sal:=&amp;工资;</span><br><span class="line">     if v_sal&lt;0 then </span><br><span class="line">       raise invlite_sal; <span class="comment">-- 手动抛出异常</span></span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> v_count <span class="keyword">from</span> emp <span class="keyword">where</span> empno = v_empno;</span><br><span class="line">     if(v_count = 0) then </span><br><span class="line">        raise no_found ;  <span class="comment">--手动抛出异常</span></span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     exception            <span class="comment">--捕获异常</span></span><br><span class="line">        when no_found  then </span><br><span class="line">             dbms_output.put_line('没有符合的信息！');</span><br><span class="line">        when invlite_sal then</span><br><span class="line">             dbms_output.put_line('工资不可为负！');   </span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--记录类型</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">    <span class="keyword">type</span> rec_emp_type <span class="keyword">is</span> <span class="built_in">record</span>(</span><br><span class="line">         empno emp.empno%<span class="keyword">type</span>,</span><br><span class="line">         ename emp.ename%<span class="keyword">type</span>,</span><br><span class="line">         sal emp.sal%<span class="keyword">type</span>   </span><br><span class="line">    );</span><br><span class="line">    no_found exception;</span><br><span class="line">   rec rec_emp_type ;</span><br><span class="line">   v_count int:=0;</span><br><span class="line">   v_empno emp.empno%type:=&amp;请输入员工工号;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">select</span> <span class="keyword">count</span>(*)<span class="keyword">into</span> v_count <span class="keyword">from</span> emp <span class="keyword">where</span> empno = v_empno;</span><br><span class="line">     if v_count = 0 then</span><br><span class="line">         raise no_found;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     <span class="keyword">select</span> empno,ename,sal <span class="keyword">into</span> rec <span class="keyword">from</span> emp <span class="keyword">where</span> empno = v_empno;</span><br><span class="line">     dbms_output.put_line('员工工号：'||rec.empno  ||'员工姓名：'||rec.ename  ||'员工薪水：'||rec.sal);</span><br><span class="line">     </span><br><span class="line">     exception </span><br><span class="line">     when no_found then </span><br><span class="line">    <span class="comment">-- raise_application_error(-20010,'查无此人');</span></span><br><span class="line">       dbms_output.put_line('查无此人');</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="comment">-------------------------------------------第六章   游标---------------------------------------------------</span></span><br><span class="line"> <span class="comment">----游标(loop访问)</span></span><br><span class="line"> <span class="keyword">declare</span></span><br><span class="line">        <span class="keyword">cursor</span>  cv_emp <span class="keyword">is</span>          <span class="comment">--1.定义游标  cursor 游标名  is   （select  语句）</span></span><br><span class="line">                <span class="keyword">select</span> e.* ,<span class="keyword">rownum</span> <span class="keyword">from</span> emp e;</span><br><span class="line">        rec_emp cv_emp%rowtype;    <span class="comment">--定义一个游标类型的变量，保存每次结果</span></span><br><span class="line"> <span class="keyword">begin</span> </span><br><span class="line">        <span class="keyword">open</span> cv_emp;               <span class="comment">--2.打开游标  open 游标名；</span></span><br><span class="line">        loop</span><br><span class="line">            fetch cv_emp into rec_emp;  <span class="comment">-- 3.从游标中获取数据  ： fetch  有标明   into　变量　　　</span></span><br><span class="line">            dbms_output.put_line(rec_emp.empno||'  '||rec_emp.rownum);</span><br><span class="line">          exit when cv_emp%NOTFOUND;</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">        close cv_emp;            　<span class="comment">--4.关闭游标  close 游标名</span></span><br><span class="line"> <span class="keyword">end</span>; </span><br><span class="line"> <span class="comment">--while访问</span></span><br><span class="line"> <span class="keyword">declare</span></span><br><span class="line">        <span class="keyword">cursor</span> cv_emp <span class="keyword">is</span></span><br><span class="line">               <span class="keyword">select</span> e.*,<span class="keyword">rownum</span> <span class="keyword">from</span> emp e  ;<span class="comment">--order by empno</span></span><br><span class="line">        rec_emp cv_emp%rowtype;</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">open</span>      cv_emp;</span><br><span class="line">              fetch cv_emp into  rec_emp;     <span class="comment">--因为游标是从0开始，第零个没有数据，所以要跳过，</span></span><br><span class="line">        while cv_emp%FOUND LOOP </span><br><span class="line">              dbms_output.put_line(rec_emp.empno||' '||REC_EMP.ROWNUM);   </span><br><span class="line">              fetch cv_emp into  rec_emp;</span><br><span class="line">             </span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">        close  cv_emp;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">--for  </span></span><br><span class="line">  <span class="keyword">declare</span></span><br><span class="line">         <span class="keyword">cursor</span> cv_emp <span class="keyword">is</span></span><br><span class="line">         <span class="keyword">select</span> e.*,<span class="keyword">rownum</span> <span class="keyword">from</span> emp e  ;<span class="comment">--order by empno</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">       <span class="keyword">for</span> rec_emp <span class="keyword">in</span> cv_emp <span class="keyword">loop</span>   <span class="comment">--for 不需要特意定义   游标变量，因为   ORACLE   自动分配计数器变量</span></span><br><span class="line">             dbms_output.put_line(rec_emp.empno||<span class="string">'  '</span>||rec_emp.rownum);</span><br><span class="line">       <span class="keyword">end</span> <span class="keyword">loop</span> ;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">--for 升级版</span></span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">      <span class="keyword">for</span> rec_emp <span class="keyword">in</span> (<span class="keyword">select</span> e.*,<span class="keyword">rownum</span> <span class="keyword">from</span> emp e  )   <span class="keyword">loop</span>   <span class="comment">--直接用select 语句作为 匿名的  cursor </span></span><br><span class="line">        dbms_output.put_line(rec_emp.empno||<span class="string">'  '</span>||rec_emp.rownum);</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">loop</span> ;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">  </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="comment">/* ---------------------------------------------第六章 游标管理 作业----------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">（一）什么是游标：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">（二）隐式游标：在 PL/SQL 程序中执行DML SQL 语句时自动创建隐式游标。 并且只能访问最近执行的一条DML语句，查询只能返回一行。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">（三）显式游标用于处理返回多行的查询。</span></span><br><span class="line"><span class="comment">		1）无参数的显式游标</span></span><br><span class="line"><span class="comment">		2）带参数的显式游标</span></span><br><span class="line"><span class="comment">		   语法：</span></span><br><span class="line"><span class="comment">		      cursor 游标名(参数名  类型) is  select_statement;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">（四）隐式游标的特性：</span></span><br><span class="line"><span class="comment">       1）在PL/SQL中使用DML语句时自动创建隐式游标</span></span><br><span class="line"><span class="comment">       2）隐式游标自动声明、自动打开和自动关闭，其名为: SQL</span></span><br><span class="line"><span class="comment">       3）通过检查隐式游标的属性可以获得最近一次执行的DML 语句的信息</span></span><br><span class="line"><span class="comment">       4）游标的属性有：</span></span><br><span class="line"><span class="comment">          （1）%FOUND – SQL语句查询或影响了一行或多行时为 TRUE</span></span><br><span class="line"><span class="comment">          （2）%NOTFOUND – SQL语句没有影响任何行时为 TRUE</span></span><br><span class="line"><span class="comment">          （3）%ROWCOUNT – SQL语句影响的行数</span></span><br><span class="line"><span class="comment">          （4）%ISOPEN  - 检查游标是否打开，隐式游标始终为FALSE</span></span><br><span class="line"><span class="comment">		  </span></span><br><span class="line"><span class="comment">（五）使用游标更新行</span></span><br><span class="line"><span class="comment">       1) 查询时使用 select .. from table where 条件 for update [of column [nowait]]子句锁定需要更新的行或列。</span></span><br><span class="line"><span class="comment">	     2) update employee set sal=sal-2 where current of 游标;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--54. 显示EMP中的第四条记录。 如：游标%rowcount=4</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">       <span class="keyword">cursor</span> cv_emp <span class="keyword">is</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp;</span><br><span class="line">       rec_emp cv_emp%rowtype;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">open</span> cv_emp;</span><br><span class="line">     loop </span><br><span class="line">         fetch cv_emp into rec_emp;    <span class="comment">--先移动，再读取</span></span><br><span class="line">         if cv_emp%rowcount = 4 then </span><br><span class="line">            dbms_output.put_line(rec_emp.empno||'   '||rec_emp.ename);</span><br><span class="line">         <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">         exit when cv_emp%rowcount = 4;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">     close cv_emp;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">55：针对所有部门，按以下格式打印各部门人员姓名：</span></span><br><span class="line"><span class="comment">	部门名称：RESEARCH</span></span><br><span class="line"><span class="comment">	部门人员：SMITH,JONES,FORD</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	部门名称：ACCOUNTING</span></span><br><span class="line"><span class="comment">	部门人员：CLARK,KING,MILLER</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	两种实现提示：</span></span><br><span class="line"><span class="comment">	1）循环每个部门，用其部门号作条件去查员工表</span></span><br><span class="line"><span class="comment">	2）用显示cursor完成</span></span><br><span class="line"><span class="comment">	3）要求用FOR，会用到嵌套循环。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--方法一：不带参数游标</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">      </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">for</span> rec_emp <span class="keyword">in</span> (<span class="keyword">select</span> dname,deptno <span class="keyword">from</span> newdept d) <span class="keyword">loop</span></span><br><span class="line">                    dbms_output.put_line(<span class="string">'部门名称：'</span>||rec_emp.dname);</span><br><span class="line">                    dbms_output.put('部门人员：');</span><br><span class="line">           for rec_tep in (<span class="keyword">select</span> e.ename ename ,e.deptno deptno <span class="keyword">from</span> emp e <span class="keyword">join</span> newdept n <span class="keyword">on</span> e.deptno = n.deptno ) <span class="keyword">loop</span> </span><br><span class="line">                     <span class="keyword">if</span> rec_tep.deptno = rec_emp.deptno <span class="keyword">then</span></span><br><span class="line">                             dbms_output.put(rec_tep.ename||<span class="string">','</span>);</span><br><span class="line">                    <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">           <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">                    dbms_output.new_line;</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">--方式二：带参数游标</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">       <span class="keyword">cursor</span> cv_dept  <span class="keyword">is</span></span><br><span class="line">               <span class="keyword">select</span> * <span class="keyword">from</span> newdept ;</span><br><span class="line">       cursor cv_employee (cp_deptno emp.deptno%type)<span class="comment">--传递一个员工部门参数，根据参数锁定该部门信息</span></span><br><span class="line">               is <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno = cp_deptno;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">for</span> cp_dept <span class="keyword">in</span> cv_dept <span class="keyword">loop</span></span><br><span class="line">          dbms_output.put_line(<span class="string">'部门名称：'</span>||cp_dept.dname);</span><br><span class="line">                dbms_output.put('部门员工：');</span><br><span class="line">                </span><br><span class="line">          for cp_emp  in cv_employee(cp_dept.deptno) loop  <span class="comment">--内循环中的参数是外循环给的，通过每一个部门参数，打印结果</span></span><br><span class="line">              dbms_output.put(cp_emp.ename||',');      </span><br><span class="line">          <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">          </span><br><span class="line">          dbms_output.new_line;</span><br><span class="line">          dbms_output.new_line;  <span class="comment">--空一行</span></span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;       </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">56. 对所有员工,如果该员工职位是MANAGER，并且在DALLAS工作那么就给他薪金加15％；如果该员工职位是CLERK，并且在NEW</span></span><br><span class="line"><span class="comment">   YORK工作那么就给他薪金扣除5％;其他情况不作处理</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">--方式二： 游标</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">    <span class="keyword">cursor</span> cv_emp(p_job emp.job%<span class="keyword">type</span>,p_loc newdept.loc%<span class="keyword">type</span>)<span class="keyword">is</span> </span><br><span class="line">                        <span class="keyword">select</span> e.sal,e.deptno,n.loc <span class="keyword">from</span> emp e,newdept n <span class="keyword">where</span> e.deptno = n.deptno <span class="keyword">and</span> p_job = e.job <span class="keyword">and</span> p_loc = n.loc <span class="keyword">for</span> <span class="keyword">update</span>;</span><br><span class="line">    v_job emp.job%type;</span><br><span class="line">    v_loc newdept.loc%type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     v_job:=<span class="string">'&amp;工作：'</span>;</span><br><span class="line">     v_loc:='&amp;地点：';</span><br><span class="line">     for rec_emp in cv_emp(v_job,v_loc) loop </span><br><span class="line">         if v_job='MANAGER' and v_loc = 'DALLAS'  then</span><br><span class="line">          <span class="keyword">update</span> emp <span class="keyword">set</span> sal= sal*(<span class="number">1</span>+<span class="number">0.15</span>) <span class="keyword">where</span> <span class="keyword">current</span> <span class="keyword">of</span> cv_emp; </span><br><span class="line">         <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">         if v_job='CLERK' and v_loc = 'NEW YORK'  then</span><br><span class="line">          <span class="keyword">update</span> emp <span class="keyword">set</span> sal= sal*(<span class="number">1</span><span class="number">-0.05</span>) <span class="keyword">where</span> <span class="keyword">current</span> <span class="keyword">of</span> cv_emp; </span><br><span class="line">         <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--方式一:</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">       <span class="keyword">cursor</span> cv_emp <span class="keyword">is</span> <span class="keyword">select</span> empno ,e.job job, n.loc loc <span class="keyword">from</span> emp e  <span class="keyword">join</span> newdept n <span class="keyword">on</span> e.deptno = n.deptno <span class="keyword">for</span> <span class="keyword">update</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">FOR</span> rec_emp <span class="keyword">in</span> cv_emp <span class="keyword">loop</span></span><br><span class="line">         <span class="keyword">if</span> rec_emp.job =<span class="string">'MANAGER'</span> <span class="keyword">and</span> rec_emp.loc =<span class="string">'DALLAS'</span>  <span class="keyword">then</span> </span><br><span class="line">            <span class="keyword">update</span> emp <span class="keyword">set</span> sal= sal*(<span class="number">1</span>+<span class="number">0.15</span>) <span class="keyword">where</span> empno = rec_emp.empno;   <span class="comment">--where current of cv_emp;</span></span><br><span class="line">             DBMS_OUTPUT.PUT_LINE('加薪10%完成！');</span><br><span class="line">         else  if rec_emp.job ='CLERK' and rec_emp.loc ='NEW YORK'   then </span><br><span class="line">                <span class="keyword">update</span> emp <span class="keyword">set</span> sal= sal*(<span class="number">1</span><span class="number">-0.05</span>) <span class="keyword">where</span> empno = rec_emp.empno;   <span class="comment">-- where current of cv_emp;</span></span><br><span class="line">                   DBMS_OUTPUT.PUT_LINE('减薪5%完成！');</span><br><span class="line">               <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">         <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--验证过程</span></span><br><span class="line"><span class="keyword">select</span> empno ,e.job job, n.loc loc ,e.sal <span class="keyword">from</span> emp e  <span class="keyword">join</span> newdept n <span class="keyword">on</span> e.deptno = n.deptno</span><br><span class="line">   <span class="keyword">and</span> e.job = <span class="string">'MANAGER'</span> <span class="keyword">and</span> n.loc = <span class="string">'DALLAS'</span>;</span><br><span class="line">   <span class="comment">--1	7566	MANAGER	DALLAS	4275.00</span></span><br><span class="line">   <span class="comment">--1	7566	MANAGER	DALLAS	5653.69</span></span><br><span class="line"><span class="keyword">select</span> empno ,e.job job, n.loc loc,e.sal <span class="keyword">from</span> emp e  <span class="keyword">join</span> newdept n <span class="keyword">on</span> e.deptno = n.deptno</span><br><span class="line">   <span class="keyword">and</span> e.job = <span class="string">'CLERK'</span> <span class="keyword">and</span> n.loc = <span class="string">'NEW YORK'</span>;</span><br><span class="line"><span class="comment">--1	7934	CLERK	NEW YORK	1300.00</span></span><br><span class="line"><span class="comment">--1	7934	CLERK	NEW YORK	1433.25</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--57.(使用游标更新行) 编写一PL/SQL，对所有的"销售员"(SALESMAN)增加佣金500.</span></span><br><span class="line"> <span class="comment">--      1)   查询时使用 select .. from table where 条件 for update [of column [nowait]]子句锁定需要更新的行或列。</span></span><br><span class="line">	<span class="comment">--     2)   update employee set sal=sal-2 where current of 游标;</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">     <span class="keyword">cursor</span>  cv_emp(p_job emp.job%<span class="keyword">type</span>)  <span class="keyword">is</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">for</span> <span class="keyword">update</span> <span class="keyword">OF</span>  sal <span class="keyword">nowait</span>;</span><br><span class="line">     v_job emp.job%type;</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">      v_job:= <span class="string">'&amp;请输入工作'</span>;</span><br><span class="line">    for rec_emp in cv_emp(v_job)  loop</span><br><span class="line">           <span class="keyword">update</span> emp <span class="keyword">set</span> comm= comm+<span class="number">500</span> <span class="keyword">where</span> <span class="keyword">current</span> <span class="keyword">of</span> cv_emp;   <span class="comment">--update employee set sal=sal-2 where current of 游标;</span></span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--58. 编写一PL/SQL，以提升两个资格最老的"CLERK(职员)"为"HIGHTCLERK(高级职员)"。（工作时间越长，优先级越高）</span></span><br><span class="line"><span class="comment">--alter table new_scott modify  ( job varchar2(10));</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">       <span class="keyword">cursor</span> cv_emp <span class="keyword">is</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> hiredate ;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">for</span> rec_emp <span class="keyword">in</span> cv_emp <span class="keyword">loop</span></span><br><span class="line">         <span class="keyword">if</span> cv_emp%rowcount &lt;=<span class="number">2</span> <span class="keyword">then</span> </span><br><span class="line">            <span class="keyword">update</span> emp <span class="keyword">set</span> job = <span class="string">'HIGHTCLERK'</span>  <span class="keyword">where</span> empno = rec_emp.empno;</span><br><span class="line">         <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--方式二：游标方式</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">       <span class="comment">--游标选定job为CLERK    的员工，并按受雇时间</span></span><br><span class="line">       <span class="keyword">cursor</span> cv_emp <span class="keyword">is</span> </span><br><span class="line">              <span class="keyword">select</span> hiredate ,job <span class="keyword">from</span> emp <span class="keyword">where</span> job = <span class="string">'CLERK'</span> <span class="keyword">order</span> <span class="keyword">by</span> hiredate  <span class="keyword">for</span> <span class="keyword">update</span> ;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">       <span class="keyword">for</span> rec_emp <span class="keyword">in</span> cv_emp <span class="keyword">loop</span></span><br><span class="line">       <span class="keyword">if</span> cv_emp%rowcount &lt;<span class="number">3</span> <span class="keyword">then</span> <span class="comment">--限制只修改两个</span></span><br><span class="line">           <span class="keyword">update</span> new_scott <span class="keyword">set</span> job = <span class="string">'HIGHTCLERK'</span> <span class="keyword">where</span> <span class="keyword">current</span> <span class="keyword">of</span> cv_emp;</span><br><span class="line">           <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">       <span class="keyword">end</span> <span class="keyword">loop</span>; </span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">select</span> * <span class="keyword">from</span> new_scott;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">59. 对直接上级是'BLAKE'的所有员工，按照参加工作的时间加薪：</span></span><br><span class="line"><span class="comment">	81年6月以前的加薪10％</span></span><br><span class="line"><span class="comment">	81年6月以后的加薪5％</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="keyword">cursor</span> cv_emp <span class="keyword">is</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> mgr = (<span class="keyword">select</span> empno <span class="keyword">from</span> emp <span class="keyword">where</span> ename = <span class="string">'BLAKE'</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">for</span> rec_emp <span class="keyword">in</span> cv_emp <span class="keyword">loop</span></span><br><span class="line">        <span class="keyword">if</span> MONTHS_BETWEEN(rec_emp.hiredate,<span class="keyword">to_date</span>(<span class="string">'1981/6/1'</span>,<span class="string">'yyyy/mm/dd'</span>))&gt;<span class="number">0</span>  <span class="keyword">then</span> </span><br><span class="line">             <span class="keyword">update</span> emp <span class="keyword">set</span> sal=sal*(<span class="number">1</span>+<span class="number">0.05</span>) <span class="keyword">where</span> empno = rec_emp.empno;</span><br><span class="line">        else</span><br><span class="line">             <span class="keyword">update</span> emp <span class="keyword">set</span> sal=sal*(<span class="number">1</span>+<span class="number">0.1</span>) <span class="keyword">where</span> empno = rec_emp.empno ;</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"><span class="comment">--方式二：游标方法</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">        <span class="keyword">cursor</span> cv_emp(p_ename emp.ename%<span class="keyword">type</span>) <span class="keyword">is</span> </span><br><span class="line">           <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> mgr = (<span class="keyword">select</span> empno <span class="keyword">from</span> emp <span class="keyword">where</span> ename = p_ename)  <span class="keyword">for</span> <span class="keyword">update</span>  <span class="keyword">of</span> sal;</span><br><span class="line">        v_ename emp.ename%type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">        v_ename:= <span class="string">'&amp;上级姓名'</span>;</span><br><span class="line">        for rec_emp in cv_emp(v_ename) loop</span><br><span class="line">            if MONTHS_BETWEEN(rec_emp.hiredate,to_date('1981/6/1','yyyy/mm/dd'))&gt;0  then </span><br><span class="line">             <span class="keyword">update</span> emp <span class="keyword">set</span> sal=sal*(<span class="number">1</span>+<span class="number">0.05</span>) <span class="keyword">where</span> <span class="keyword">current</span> <span class="keyword">of</span> cv_emp;</span><br><span class="line">        else</span><br><span class="line">             <span class="keyword">update</span> emp <span class="keyword">set</span> sal=sal*(<span class="number">1</span>+<span class="number">0.1</span>) <span class="keyword">where</span> <span class="keyword">current</span> <span class="keyword">of</span> cv_emp ;</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">if</span>; </span><br><span class="line">            </span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*----------------------------------------------------第7章 过程和函数----------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">60. 编写一个给指定雇员加薪10%的过程：Raise_Sal(p_ename)，这之后，检查如果已经雇佣该雇员超过60个月，则给他额外加薪3000.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span>  <span class="keyword">procedure</span> Raise_Sal(p_ename emp.ename%<span class="keyword">type</span>)</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line">  <span class="keyword">cursor</span> cv_rise(p_ename emp.ename%<span class="keyword">type</span>)  <span class="keyword">is</span> <span class="keyword">select</span> * <span class="keyword">from</span>  emp <span class="keyword">where</span> ename = p_ename <span class="keyword">for</span> <span class="keyword">update</span> <span class="keyword">of</span> sal;</span><br><span class="line">  cursor cv_emp is <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> months_between(<span class="keyword">sysdate</span>,hiredate)&gt;<span class="number">60</span>  <span class="keyword">for</span> <span class="keyword">update</span> <span class="keyword">of</span> sal;<span class="comment">--后一部分</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">for</span> emp <span class="keyword">in</span> cv_rise(p_ename) <span class="keyword">loop</span></span><br><span class="line">          <span class="keyword">update</span>  emp <span class="keyword">set</span> sal=sal*(<span class="number">1</span>+<span class="number">0.1</span>) <span class="keyword">where</span> <span class="keyword">current</span> <span class="keyword">of</span> cv_rise ;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"></span><br><span class="line">     for emp in cv_emp loop</span><br><span class="line">         <span class="keyword">update</span> emp <span class="keyword">set</span> sal = sal+<span class="number">3000</span> <span class="keyword">WHERE</span> <span class="keyword">current</span> <span class="keyword">of</span> cv_emp ;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">     <span class="comment">--commit;</span></span><br><span class="line">     exception </span><br><span class="line">      when others then</span><br><span class="line">      <span class="keyword">rollback</span>;</span><br><span class="line">      dbms_output.put_line('操作有误，已经撤销！');</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--调用</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">     v_ename emp.ename%<span class="keyword">type</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     v_ename:=<span class="string">'&amp;需要加薪的员工的名字：'</span>;</span><br><span class="line">     Raise_Sal(v_ename);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">--验证</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">61. 编写一个过程打印出99的乘法表。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">procedure</span> pro_9_9</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.9</span> <span class="keyword">loop</span></span><br><span class="line">       <span class="keyword">for</span> j <span class="keyword">in</span> <span class="number">1.</span>.i <span class="keyword">loop</span></span><br><span class="line">         dbms_output.put(i||<span class="string">'*'</span>||j||<span class="string">'='</span>||i*j||<span class="string">'  '</span>);</span><br><span class="line">       <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">       dbms_output.new_line;</span><br><span class="line">   <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--调用过程</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     pro_9_9;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">62.编写一个过程完成两个数字的交换</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">procedure</span> date_change(no1 <span class="keyword">in</span> <span class="keyword">out</span> <span class="built_in">int</span>,no2 <span class="keyword">in</span> <span class="keyword">out</span> <span class="built_in">integer</span> )</span><br><span class="line"><span class="keyword">is</span> </span><br><span class="line">   v_temp <span class="built_in">int</span> ;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     v_temp := no1;</span><br><span class="line">     no1 := no2;</span><br><span class="line">     no2 := v_temp;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">--调用</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"> v_on1 <span class="built_in">int</span> :=&amp;请输入第一个数字;</span><br><span class="line">  v_on2 int :=&amp;请输入第二个数字;</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">      date_change(v_on1,v_on2);</span><br><span class="line">      dbms_output.put_line('交换后：第一个数字：'||v_on1||'   第二个参数：'||v_on2);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">                                                              --drop table log_msg cascade constraint;//删除表同时删除约束</span></span><br><span class="line"><span class="comment">63. 编写三个过程完成</span></span><br><span class="line"><span class="comment">	(1)开户功能。open_account(.....);</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">	(2)两个账户的转账功能。transaction(from帐户，to帐户,money)</span></span><br><span class="line"><span class="comment">       a)检查帐户是否存大？不存在的情况出异常。</span></span><br><span class="line"><span class="comment">       b)转入转出帐户必须要在一个事务里进行。</span></span><br><span class="line"><span class="comment">         </span></span><br><span class="line"><span class="comment">	(3)根据转出账号和交易时间段 可查询转出账号的所有交易记录。最后还需要返回该时间段转出的总金额。</span></span><br><span class="line"><span class="comment">      a)向“交易日志表”插入数据。</span></span><br><span class="line"><span class="comment">      b)交易号的生成规则：'T10000-'||trans_seq.nextval --&gt; T10000-1000</span></span><br><span class="line"><span class="comment">      </span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">	表结构如下：</span></span><br><span class="line"><span class="comment">	 1. 账户表：账号（6722 6738 xxxx yyyy）,户名，身份证号，余额，开户时间。</span></span><br><span class="line"><span class="comment">	    </span></span><br><span class="line"><span class="comment">      说明：账号后8位数随机生成。dbms_random.value函数可以得一个八位小数的随机小数。</span></span><br><span class="line"><span class="comment">	       select dbms_random.value from dual;</span></span><br><span class="line"><span class="comment">select trunc(dbms_random.value*100000000,0) from dual;</span></span><br><span class="line"><span class="comment">	 2. 交易日志表：交易号(T10000-999)，转出账户，转入账户，交易金额，交易时间systimestamp。</span></span><br><span class="line"><span class="comment">	    说明：交易号使用序列生成。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">--1.custome_account表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> custome_account (</span><br><span class="line">       accountno varchar2(<span class="number">16</span>) <span class="keyword">not</span> <span class="literal">null</span> primary <span class="keyword">key</span> ,</span><br><span class="line">       aname varchar2(<span class="number">6</span>)  <span class="keyword">not</span> <span class="literal">null</span> ,</span><br><span class="line">       idno  varchar2(<span class="number">18</span>)<span class="keyword">unique</span>,</span><br><span class="line">       money <span class="built_in">number</span>(<span class="number">20</span>,<span class="number">3</span>) <span class="keyword">check</span> (money&gt;<span class="number">0</span>),</span><br><span class="line">       opentime <span class="built_in">date</span> <span class="keyword">default</span> systimestamp    </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--1.1建立账号表视图</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span>  <span class="keyword">view</span> <span class="keyword">acc</span> </span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> custome_account;</span><br><span class="line"></span><br><span class="line"><span class="comment">--2.logtable 表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> log_msg (</span><br><span class="line">       tradeno varchar2(<span class="number">11</span>)<span class="keyword">not</span> <span class="literal">null</span> primary <span class="keyword">key</span>,</span><br><span class="line">       fromaccount varchar2(<span class="number">16</span>) ,</span><br><span class="line">       toaccourt   varchar2(<span class="number">16</span>),</span><br><span class="line">       money <span class="built_in">number</span>(<span class="number">20</span>,<span class="number">3</span>),</span><br><span class="line">       tradetime <span class="built_in">date</span> <span class="keyword">default</span> systimestamp,</span><br><span class="line">       <span class="keyword">constraint</span>  FK_ACCOUT_LOG_FROMACCOUT foreign <span class="keyword">key</span>(fromaccount)  <span class="keyword">referenceS</span>   custome_account(accountno),</span><br><span class="line">       <span class="keyword">constraint</span>  FK_ACCOUT_LOG_TOACCOUT foreign <span class="keyword">key</span>(toaccourt) <span class="keyword">referenceS</span>   custome_account(accountno)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--1.1建立交易表视图</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span>  <span class="keyword">view</span> tra </span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> log_msg;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--1.2 建立开户过程</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">procedure</span> open_account(p_aname acc.aname%<span class="keyword">type</span>,aid acc.idno%<span class="keyword">type</span>,money acc.money%<span class="keyword">type</span>, p_accountno <span class="keyword">out</span> acc.ACCOUNTNO%<span class="keyword">type</span>  )</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line">   v_rand <span class="built_in">number</span>(<span class="number">20</span>);</span><br><span class="line">   v_num int default 0;</span><br><span class="line">   v_account acc.ACCOUNTNO%type;</span><br><span class="line">   id_has_exist exception;  <span class="comment">--该身份证已经开过户</span></span><br><span class="line">   name_has_exist exception;  <span class="comment">--该姓名已经注册</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> v_num <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> aid= idno;</span><br><span class="line">     if v_num &gt; 0 then </span><br><span class="line">          raise id_has_exist;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">      <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> v_num <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> ANAME= p_aname ;</span><br><span class="line">     if v_num &gt; 0 then </span><br><span class="line">          raise name_has_exist;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     <span class="keyword">select</span> trunc(dbms_random.value*<span class="number">100000000</span>,<span class="number">0</span>) <span class="keyword">into</span> v_rand  <span class="keyword">from</span> dual;<span class="comment">--产生一个8位的随机数</span></span><br><span class="line">     v_account:=CONCAT('67226738',to_char(v_rand));                     <span class="comment">--根据前缀产生一个账号</span></span><br><span class="line">     p_accountno:=v_account;   <span class="comment">--作为返回值返回                      </span></span><br><span class="line">     <span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">acc</span> <span class="keyword">values</span>(v_account,p_aname,aid,money,<span class="keyword">sysdate</span>);</span><br><span class="line">     dbms_output.put_line(v_account||' '||p_aname||' '||aid||' '||money||' '||sysdate);<span class="comment">--检验输出</span></span><br><span class="line">     <span class="keyword">commit</span>;</span><br><span class="line">     exception</span><br><span class="line">       when id_has_exist then </span><br><span class="line">       raise_application_error('-20012','该身份证已经开户,请换其他身份证继续！！');</span><br><span class="line">       when name_has_exist then </span><br><span class="line">       raise_application_error('-20002','该客户已经存在，不能重名！！');</span><br><span class="line">       when others then</span><br><span class="line">       <span class="keyword">rollback</span>;</span><br><span class="line">       raise_application_error('-20011','操作失败,已撤销！！');</span><br><span class="line"><span class="keyword">end</span> open_account;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">--1.3 测试(------------------------------------------开户过程----------------------------------------)</span></span><br><span class="line"> <span class="keyword">declare</span> </span><br><span class="line">      aname acc.aname%<span class="keyword">type</span>;</span><br><span class="line">      aid acc.idno%type;</span><br><span class="line">      money acc.money%type;</span><br><span class="line">      v_account acc.ACCOUNTNO%type;<span class="comment">--记录返回账号</span></span><br><span class="line">  <span class="keyword">begin</span> </span><br><span class="line">      aname:=<span class="string">'&amp;开户姓名'</span>;</span><br><span class="line">      aid:='&amp;身份证号';</span><br><span class="line">      money:=&amp;余额;</span><br><span class="line">      open_account(aname,aid,money,v_account);</span><br><span class="line">      dbms_output.put_line('恭喜您开户成功！您的账户为：'||v_account);</span><br><span class="line">  <span class="keyword">end</span> ;  </span><br><span class="line">  </span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--2.1 转账功能工程transaction</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">procedure</span> pro_tract(p_fromaccount tra.FROMACCOUNT%<span class="keyword">type</span>,</span><br><span class="line">                            p_toaccount tra.TOACCOURT%<span class="keyword">type</span>,p_money tra.MONEY%<span class="keyword">type</span>)</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line">   v_counter <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">   v_money tra.MONEY%type;</span><br><span class="line">   no_found_from exception;</span><br><span class="line">   no_found_to exception;</span><br><span class="line">   no_enough exception;</span><br><span class="line">   data_error exception;</span><br><span class="line">   no_equals exception;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     </span><br><span class="line">     <span class="keyword">if</span> p_money&lt;<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">raise</span> data_error;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> v_counter <span class="keyword">from</span> <span class="keyword">acc</span>  <span class="keyword">where</span>  ACCOUNTNO = p_fromaccount;</span><br><span class="line">     if v_counter = 0 then</span><br><span class="line">         raise no_found_from;</span><br><span class="line">         <span class="keyword">end</span> <span class="keyword">if</span> ;</span><br><span class="line">     <span class="keyword">select</span> money <span class="keyword">into</span> v_money <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> ACCOUNTNO = p_fromaccount;</span><br><span class="line">     if  (v_money- p_money)&lt;0 then</span><br><span class="line">          raise no_enough;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span> ;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">     <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> v_counter <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span>  ACCOUNTNO = p_toaccount;</span><br><span class="line">     if v_counter = 0 then</span><br><span class="line">         raise no_found_to;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span> ;</span><br><span class="line">     if p_fromaccount = p_toaccount then</span><br><span class="line">        raise no_equals;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">update</span> <span class="keyword">acc</span> <span class="keyword">set</span> money = money-p_money <span class="keyword">where</span> acc.ACCOUNTNO = p_fromaccount;</span><br><span class="line">     <span class="keyword">update</span> <span class="keyword">acc</span> <span class="keyword">set</span> money = money+p_money <span class="keyword">where</span> acc.ACCOUNTNO = p_toaccount;</span><br><span class="line">   </span><br><span class="line">      <span class="keyword">insert</span> <span class="keyword">into</span> tra(tradeno,fromaccount,toaccourt,money) <span class="keyword">values</span> ( to_char(<span class="string">'T10000-'</span>||to_char(sq_tra_log.nextval)) ,p_fromaccount, p_toaccount,p_money);<span class="comment">-----------------------------------------</span></span><br><span class="line">      dbms_output.put_line('转账成功！');</span><br><span class="line">      <span class="keyword">commit</span>;</span><br><span class="line">     exception</span><br><span class="line">      when no_found_from then</span><br><span class="line">      raise_application_error('-20013','转出账户不存在！');</span><br><span class="line">      when no_found_to then</span><br><span class="line">      raise_application_error('-20014','转入账户不存在！');</span><br><span class="line">      when no_enough then</span><br><span class="line">      raise_application_error('-20015','转出账户余额不足！');</span><br><span class="line">       when data_error then</span><br><span class="line">      raise_application_error('-20016','转账数额不能为负值！');</span><br><span class="line">      when no_equals then </span><br><span class="line">       raise_application_error('-20030','转出账户与转入账户相同！');</span><br><span class="line">      when  others then</span><br><span class="line">      raise_application_error('-20017','操作失败,动作已撤销！');</span><br><span class="line">      <span class="keyword">rollback</span>;</span><br><span class="line"><span class="keyword">end</span> pro_tract; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span>;  </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tra;  </span><br><span class="line"><span class="comment">--2.2 测试(-------------------------------------------------转账过程测试----------------------------------)</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">       v_fromaccount tra.FROMACCOUNT%<span class="keyword">type</span>;</span><br><span class="line">       v_toaccount tra.TOACCOURT%type;</span><br><span class="line">       v_money tra.MONEY%type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">       v_fromaccount :=<span class="string">'&amp;转账账号'</span>;</span><br><span class="line">       v_toaccount :='&amp;收账账号';</span><br><span class="line">       v_money:=&amp;转账金额;</span><br><span class="line">       pro_tract(v_fromaccount,v_toaccount,v_money);</span><br><span class="line">       <span class="keyword">commit</span>;</span><br><span class="line">      <span class="comment">/* exception              -- 加了这个异常后，raise_application_error 不在显示</span></span><br><span class="line"><span class="comment">        when others then </span></span><br><span class="line"><span class="comment">        dbms_output.put_line('转账失败！');*/</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--2.3创建序列</span></span><br><span class="line"> <span class="keyword">create</span> <span class="keyword">sequence</span>  sq_tra_log </span><br><span class="line"> <span class="keyword">start</span> <span class="keyword">with</span> <span class="number">999</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">--3.1</span></span><br><span class="line"><span class="comment">/*	(3)根据转出账号和交易时间段 可查询转出账号的所有交易记录。最后还需要返回该时间段转出的总金额。</span></span><br><span class="line"><span class="comment">      a)向“交易日志表”插入数据。</span></span><br><span class="line"><span class="comment">      b)交易号的生成规则：'T10000-'||trans_seq.nextval --&gt; T10000-1000</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">procedure</span> pro_search_trace(p_fromaccount tra.FROMACCOUNT%<span class="keyword">type</span>,</span><br><span class="line">                                             begintime <span class="built_in">date</span>,endtime <span class="built_in">date</span>,</span><br><span class="line">                                             totalmoney <span class="keyword">out</span> tra.MONEY%<span class="keyword">type</span>)</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line">      <span class="keyword">cursor</span> cv_accot <span class="keyword">is</span></span><br><span class="line">             <span class="keyword">select</span> * <span class="keyword">from</span> tra <span class="keyword">where</span> FROMACCOUNT = p_fromaccount</span><br><span class="line">             <span class="keyword">and</span> TRADETIME <span class="keyword">between</span> begintime <span class="keyword">and</span> endtime ;</span><br><span class="line">      v_counter int default 0;</span><br><span class="line">      time_error exception;</span><br><span class="line">      no_found_from exception;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">if</span> months_between(begintime ,endtime)&gt;<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">raise</span> time_error;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> v_counter <span class="keyword">from</span> tra  <span class="keyword">where</span>  FROMACCOUNT = p_fromaccount;</span><br><span class="line">     if v_counter = 0 then</span><br><span class="line">         raise no_found_from;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span> ;</span><br><span class="line">      totalmoney:=0;</span><br><span class="line">        dbms_output.put_line(p_fromaccount||' 在 '||to_char(begintime,</span><br><span class="line">      'yyyy"年"mm"月"dd"日"')||' ~ '||to_char(endtime,'yyyy"年"mm"月"dd"日"')||' 时间段内的交易清单：');</span><br><span class="line">      dbms_output.new_line;</span><br><span class="line">      for tra_accot in cv_accot loop</span><br><span class="line">           totalmoney:=totalmoney+tra_accot.MONEY; </span><br><span class="line">           dbms_output.put_line(tra_accot.tradeno||'   '||tra_accot.fromaccount||</span><br><span class="line">           '   '||tra_accot.toaccourt||'   '||to_char(tra_accot.money,'L999,999,999.00')||'   '||to_char(tra_accot.tradetime,'yyyy"年"mm"月"dd"日"'));</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">         dbms_output.new_line;</span><br><span class="line">      exception</span><br><span class="line">      when time_error then </span><br><span class="line">           raise_application_error('-20040','起始时间不能晚于结束时间！');</span><br><span class="line">      when no_found_from then</span><br><span class="line">           raise_application_error('-20018','没有发现该账户的交易记录！');</span><br><span class="line">      when others then</span><br><span class="line">           raise_application_error('-20019','查询异常！');</span><br><span class="line"><span class="keyword">end</span> pro_search_trace ;</span><br><span class="line"></span><br><span class="line"><span class="comment">--3.2 测试(----------------------------------------------------交易记录查询测试------------------------------------------------------)</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">      p_fromaccount tra.FROMACCOUNT%<span class="keyword">type</span>;</span><br><span class="line">      begintime date;</span><br><span class="line">      endtime date;</span><br><span class="line">      v_totalmony tra.MONEY%type ;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">      p_fromaccount:=<span class="string">'&amp;请输入查询账户'</span>;</span><br><span class="line">      begintime:=to_date('&amp;请输入开始时间','yyyy/mm/dd');</span><br><span class="line">      endtime:=to_date('&amp;请输入结束时间','yyyy/mm/dd');</span><br><span class="line">      pro_search_trace(p_fromaccount,begintime ,endtime,v_totalmony );</span><br><span class="line">      dbms_output.put_line('合计：');</span><br><span class="line">      dbms_output.put_line(p_fromaccount||' 在 '||to_char(begintime,</span><br><span class="line">      'yyyy"年"mm"月"dd"日"')||' ~ '||to_char(endtime,'yyyy"年"mm"月"dd"日"')||' 时间段内的交易额为: '||to_char(v_totalmony,'L999,999.00'));</span><br><span class="line"><span class="keyword">end</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tra;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*-----------------------------------------------------------------函数 -----------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--65. 基于账户表，编写一个函数通过账号获得账户余额；如果输入的账号不存在则显示相应的异常信息。</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">function</span> get_balance (accno acc.ACCOUNTNO%<span class="keyword">type</span>)</span><br><span class="line">   <span class="keyword">return</span> <span class="built_in">number</span></span><br><span class="line"> <span class="keyword">is</span> </span><br><span class="line">    v_balance acc.MONEY%<span class="keyword">type</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">select</span> money <span class="keyword">into</span> v_balance <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> ACCOUNTNO = accno;</span><br><span class="line">      return v_balance ;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">---</span></span><br><span class="line"> <span class="keyword">select</span> get_balance(<span class="string">'6722673861353700'</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">--66. 检测一个值是否落在了正常的员工工资范围内</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">function</span> check_sal (sal salgrade.losal%<span class="keyword">type</span>)</span><br><span class="line">   <span class="keyword">return</span> varchar2</span><br><span class="line">   <span class="keyword">is</span></span><br><span class="line">   v_losal salgrade.losal%<span class="keyword">type</span>;</span><br><span class="line">    v_hisal salgrade.losal%type;</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">select</span> <span class="keyword">min</span>(losal)<span class="keyword">into</span> v_losal <span class="keyword">from</span> salgrade;</span><br><span class="line">      <span class="keyword">select</span> <span class="keyword">max</span>(hisal) <span class="keyword">into</span> v_hisal <span class="keyword">from</span> salgrade;</span><br><span class="line">      if sal&gt;v_losal and sal &lt;  v_hisal then</span><br><span class="line">           return '在正常工资范围！';</span><br><span class="line">      else</span><br><span class="line">           return '不在正常工资范围！';</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">if</span> ;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">select</span> check_sal(<span class="number">690</span>) <span class="keyword">from</span> dual;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> salgrade;</span><br><span class="line"><span class="comment">--67. 编写一个函数获得指定部门的平均工资。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">function</span> get_avg_sal(p_dname newdept.dname%<span class="keyword">type</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">number</span></span><br><span class="line"><span class="keyword">is</span> </span><br><span class="line">   v_avg new_scott.sal%<span class="keyword">type</span>;</span><br><span class="line">   v_counter int default 0;</span><br><span class="line">   no_dept exception;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">select</span> <span class="keyword">count</span>(dname) <span class="keyword">into</span> v_counter  <span class="keyword">from</span> newdept <span class="keyword">where</span> p_dname=dname;</span><br><span class="line">     if(v_counter=0) then </span><br><span class="line">         raise no_dept;</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">select</span> <span class="keyword">avg</span>(sal) <span class="keyword">into</span> v_avg <span class="keyword">from</span> new_scott <span class="keyword">where</span> deptno =</span><br><span class="line">       (<span class="keyword">select</span> deptno <span class="keyword">from</span> newdept <span class="keyword">where</span> dname = p_dname);</span><br><span class="line">     return v_avg;</span><br><span class="line">     </span><br><span class="line">     exception</span><br><span class="line">     when no_dept then </span><br><span class="line">        raise_application_error('-20048','不存在该部门');</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--SQL/PL语句</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">     v_dname newdept.dname%<span class="keyword">type</span>;</span><br><span class="line">     v_avg_sal new_scott.sal%type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     v_dname:=<span class="string">'&amp;请输入部门名称'</span>;</span><br><span class="line">     v_avg_sal:= get_avg_sal(v_dname) ;</span><br><span class="line">     dbms_output.put_line(v_avg_sal);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> newdept;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--68. 综合应用，利用第67题的函数，编写一个过程将所有部门的平均显示出来。</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">procedure</span> search_avg</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line">       <span class="keyword">cursor</span> cv_dept <span class="keyword">is</span> <span class="keyword">select</span> dname <span class="keyword">from</span> newdept;</span><br><span class="line">       v_avg new_scott.sal%type default 0;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">       <span class="keyword">for</span> rec_dname <span class="keyword">in</span> cv_dept <span class="keyword">loop</span></span><br><span class="line">       v_avg := get_avg_sal(rec_dname.dname);</span><br><span class="line">             dbms_output.put_line(rec_dname.dname||'部门的平均工资是：'||v_avg);</span><br><span class="line">       <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">search_avg;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-------------------------------------------------触发器----------------------------------trigger</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*--------------------------------------------------(了解) 触发器 --------------------------------------------------------</span></span><br><span class="line"><span class="comment"> 1. 什么是触发器：触发器在数据库里以独立的对象存储，它与存储过程和函数不同的是，存储过程与函数需要用户显示调用才执行，</span></span><br><span class="line"><span class="comment">	而触发器是由一个事件来启动运行。即触发器是当某个事件发生时自动地隐式运行。并且，触发器不能接收参数。</span></span><br><span class="line"><span class="comment">	所以运行触发器就叫触发或点火。</span></span><br><span class="line"><span class="comment"> 2. ORACLE事件指的是对数据库的表进行的INSERT、UPDATE及DELETE操作或对视图进行类似的操作。</span></span><br><span class="line"><span class="comment"> 3. 触发器不接受参数。</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 触发器组成: </span></span><br><span class="line"><span class="comment">	1)触发事件：引起触发器被触发的事件。 例如：DML语句(INSERT, UPDATE, DELETE语句对表或视图执行数据处理操作)、</span></span><br><span class="line"><span class="comment">	  DDL语句（如CREATE、ALTER、DROP语句在数据库中创建、修改、删除模式对象）、数据库系统事件（如系统启动或退出、异常错误）、</span></span><br><span class="line"><span class="comment">	  用户事件（如登录或退出数据库）。</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	2)触发时间：即该TRIGGER 是在触发事件发生之前（BEFORE）还是之后(AFTER)触发，也就是触发事件和该TRIGGER 的操作顺序。</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	3)触发操作：即该TRIGGER 被触发之后的目的和意图，正是触发器本身要做的事情。 例如：PL/SQL 块。</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	4)触发对象：包括表、视图、模式、数据库。只有在这些对象上发生了符合触发条件的触发事件，才会执行触发操作。</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	5)触发条件：由WHEN子句指定一个逻辑表达式。只有当该表达式的值为TRUE时，遇到触发事件才会自动执行触发器，</span></span><br><span class="line"><span class="comment">	  使其执行触发操作。</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	6)触发频率：说明触发器内定义的动作被执行的次数。即语句级(STATEMENT)触发器和行级(ROW)触发器。</span></span><br><span class="line"><span class="comment">		a)语句级(STATEMENT)触发器：是指当某触发事件发生时，该触发器只执行一次；</span></span><br><span class="line"><span class="comment">		b)行级(ROW)触发器：是指当某触发事件发生时，对受到该操作影响的每一行数据，触发器都单独执行一次。</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> REFERENCING 参照名称：OLD,NEW都是代表当前操作的记录行</span></span><br><span class="line"><span class="comment">	1) 默认的相关名称分别为OLD和NEW，参照当前DML操作的新、旧列值</span></span><br><span class="line"><span class="comment">	2) 触发器的PL/SQL块中应用相关名称时，必须在它们之前加冒号(:)，但在WHEN子句(触发条件)中则不能加冒号。</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">create or replace trigger 触发器名</span></span><br><span class="line"><span class="comment">   触发时间(BEFORE|AFTER)  触发事件(INSERT OR UPDATE OR DELETE) [of 列名] on 触发对象(表等)</span></span><br><span class="line"><span class="comment">      触发频率 </span></span><br><span class="line"><span class="comment">         when (触发条件) </span></span><br><span class="line"><span class="comment">declare</span></span><br><span class="line"><span class="comment">   --声明变量等</span></span><br><span class="line"><span class="comment">   </span></span><br><span class="line"><span class="comment">begin</span></span><br><span class="line"><span class="comment">   --执行部分</span></span><br><span class="line"><span class="comment">   </span></span><br><span class="line"><span class="comment">end 触发器名;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--当更新或插入员工的奖金时，其奖金comm大于1000时，sal工资自动多加10元</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> auto_raise_sal_trg</span><br><span class="line">   <span class="keyword">before</span> <span class="keyword">insert</span> <span class="keyword">or</span> <span class="keyword">update</span> <span class="keyword">of</span> comm <span class="keyword">on</span> employee</span><br><span class="line">      <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span> <span class="comment">--表示行级触发器</span></span><br><span class="line">         <span class="keyword">when</span> (NEW.comm&gt;=<span class="number">1000</span>)</span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">--触发器里预定义了三个操作条件</span></span><br><span class="line">   <span class="comment">-- inserting,updating,deleting触发动作条件，其值为boolean，只能在触发器主体中使用</span></span><br><span class="line">   <span class="keyword">if</span> inserting <span class="keyword">then</span></span><br><span class="line">      <span class="comment">--触发器的PL/SQL块中应用相关名称时，必须在它们之前加冒号(:)，但在WHEN子句(触发条件)中则不能加冒号。</span></span><br><span class="line">      :NEW.sal := :NEW.sal + <span class="number">10</span>;</span><br><span class="line">   <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">   if updating then</span><br><span class="line">      :NEW.sal := :OLD.sal + 10;  </span><br><span class="line">   <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span> auto_raise_sal_trg;</span><br><span class="line"></span><br><span class="line"><span class="comment">--建表 test_trg</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> test_trg;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test_trg(</span><br><span class="line">  tid varchar2(<span class="number">4</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">sequence</span> test_trg_seq</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--使用触发器为表在插入数据时生成一个id值：A序号(序号用序列生成)</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test_id(</span><br><span class="line">	tid varchar2(<span class="number">4</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">sequence</span> test_id_sq</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> auto_id</span><br><span class="line">    	<span class="keyword">before</span> <span class="keyword">insert</span>  <span class="keyword">on</span> test_id</span><br><span class="line">    	<span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span> </span><br><span class="line">    	<span class="keyword">when</span> (new.tid <span class="keyword">is</span> <span class="literal">null</span>)</span><br><span class="line">  <span class="keyword">declare</span></span><br><span class="line">      v_id test_id.tid%<span class="keyword">type</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">select</span> <span class="string">'A'</span>||test_id_sq.nextval <span class="keyword">into</span> v_id <span class="keyword">from</span> dual;</span><br><span class="line">      :new.tid := v_id;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test_id <span class="keyword">values</span>(<span class="string">'159'</span>);</span><br><span class="line">  <span class="keyword">select</span> * <span class="keyword">from</span> test_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">--删除触发器</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> auto_raise_sal_trg;</span><br><span class="line"></span><br><span class="line"><span class="comment">--禁用或启用触发器</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">trigger</span> auto_raise_sal_trg <span class="keyword">disable</span>; <span class="comment">--enable</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee(empno,ename,job,sal,comm,deptno) </span><br><span class="line">  <span class="keyword">values</span>(employee_seq.nextval,<span class="string">'小美'</span>,<span class="string">'CLERK'</span>,<span class="number">4000.0</span>,<span class="number">1000</span>,<span class="number">10</span>);</span><br><span class="line">  </span><br><span class="line"><span class="keyword">update</span> employee <span class="keyword">set</span> comm=<span class="number">1500</span> <span class="keyword">where</span> ENAME=<span class="string">'小美'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">------------------------------------------------</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> employee <span class="keyword">WHERE</span> ENAME=<span class="string">'小美'</span> <span class="keyword">order</span> <span class="keyword">by</span> empno <span class="keyword">DESC</span>; </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> department;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> salgrade;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

      
    </div>

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/03/19/各大互联网公司架构汇总/" rel="next" title="各大互联网公司架构汇总">
                <i class="fa fa-chevron-left"></i> 各大互联网公司架构汇总
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
<span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_fav">收藏夹</a>
<a class="jiathis_button_copy">复制网址</a>
<a class="jiathis_button_email">邮件</a>
<a class="jiathis_button_weixin">微信</a>
<a class="jiathis_button_qzone">QQ空间</a>
<a class="jiathis_button_tqq">腾讯微博</a>
<a class="jiathis_button_douban">豆瓣</a>
<a class="jiathis_button_share">一键分享</a>

<a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
var jiathis_config={
  data_track_clickback:true,
  summary:"",
  shortUrl:false,
  hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script>
<!-- JiaThis Button END -->
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div class="ds-thread" data-thread-key="2018/03/19/Oracle课堂笔记/"
           data-title="Oracle课堂笔记" data-url="http:/jackcooper.github.io/2018/03/19/Oracle课堂笔记/">
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/jackcooper.jpg"
                alt="jackcooper" />
            
              <p class="site-author-name" itemprop="name">jackcooper</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/jackcooper2015" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="1040078821@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-globe"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
<!--    <div id="music163player">
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=440241144&auto=0&height=66"></iframe>
    </div> -->
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">
<script charset="Shift_JIS" src="http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock_tr.js"></script>
</div>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jackcooper</span>

  
</div>


<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>

-->



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"jackcooper"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  


















  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  <script>
   var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();
     function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
     function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
     function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
     var Circle = function () {
        function Circle(x, y) {
             _classCallCheck(this, Circle);
             this.x = x;
             this.y = y;
             this.r = Math.random() * 10;
             this._mx = Math.random();
             this._my = Math.random();
         }
        _createClass(Circle, [{
             key: 'drawCircle',
             value: function drawCircle(ctx) {
                 ctx.beginPath();
                 //arc() 方法使用一个中心点和半径，为一个画布的当前子路径添加一条弧。
                 ctx.arc(this.x, this.y, this.r, 0, 360);
                 ctx.closePath();
                 ctx.fillStyle = 'rgba(204, 204, 204, 0.3)';
                 ctx.fill();
             }
         }, {
             key: 'drawLine',
             value: function drawLine(ctx, _circle) {
                 var dx = this.x - _circle.x;
                 var dy = this.y - _circle.y;
                 var d = Math.sqrt(dx * dx + dy * dy);
                 if (d < 150) {
                     ctx.beginPath();
                     ctx.moveTo(this.x, this.y); //起始点
                     ctx.lineTo(_circle.x, _circle.y); //终点
                     ctx.closePath();
                     ctx.strokeStyle = 'rgba(204, 204, 204, 0.3)';
                     ctx.stroke();
                 }
             }
         }, {
             key: 'move',
             value: function move(w, h) {
                 this._mx = this.x < w && this.x > 0 ? this._mx : -this._mx;
                 this._my = this.y < h && this.y > 0 ? this._my : -this._my;
                 this.x += this._mx / 2;
                 this.y += this._my / 2;
             }
         }]);
         return Circle;
     }();
     var currentCirle = function (_Circle) {
         _inherits(currentCirle, _Circle);
         function currentCirle(x, y) {
             _classCallCheck(this, currentCirle);
             return _possibleConstructorReturn(this, (currentCirle.__proto__ || Object.getPrototypeOf(currentCirle)).call(this, x, y));
         }
         _createClass(currentCirle, [{
             key: 'drawCircle',
             value: function drawCircle(ctx) {
                 ctx.beginPath();
                 //this.r = (this.r < 14 && this.r > 1) ? this.r + (Math.random() * 2 - 1) : 2;
                 this.r = 8;
                 ctx.arc(this.x, this.y, this.r, 0, 360);
                 ctx.closePath();
                 //ctx.fillStyle = 'rgba(0,0,0,' + (parseInt(Math.random() * 100) / 100) + ')'
                 ctx.fillStyle = 'rgba(255, 77, 54, 0.6)';
                 ctx.fill();
             }
         }]);
         return currentCirle;
     }(Circle);
     window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
     var canvas = document.getElementById('canvas');
     var ctx = canvas.getContext('2d');
     var w = canvas.width = canvas.offsetWidth;
     var h = canvas.height = canvas.offsetHeight;
     var circles = [];
     var current_circle = new currentCirle(0, 0);
     var draw = function draw() {
         ctx.clearRect(0, 0, w, h);
         for (var i = 0; i < circles.length; i++) {
             circles[i].move(w, h);
             circles[i].drawCircle(ctx);
             for (j = i + 1; j < circles.length; j++) {
                 circles[i].drawLine(ctx, circles[j]);
             }
         }
         if (current_circle.x) {
             current_circle.drawCircle(ctx);
             for (var k = 1; k < circles.length; k++) {
                 current_circle.drawLine(ctx, circles[k]);
             }
         }
         requestAnimationFrame(draw);
     };
     var init = function init(num) {
         for (var i = 0; i < num; i++) {
             circles.push(new Circle(Math.random() * w, Math.random() * h));
         }
         draw();
     };
     window.addEventListener('load', init(60));
     window.onmousemove = function (e) {
         e = e || window.event;
         current_circle.x = e.clientX;
         current_circle.y = e.clientY;
     };
     window.onmouseout = function () {
         current_circle.x = null;
         current_circle.y = null;
     };
  </script>
</body>
</html>
